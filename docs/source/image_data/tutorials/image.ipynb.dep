{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "0b54398e-437d-43a2-a1b3-4518fea5bfb2",
   "metadata": {},
   "source": [
    "# Image Tutorial\n",
    "The current authoritative version of the full image XDS \n",
    "schema can be found at https://docs.google.com/spreadsheets/d/1WW0Gl6z85cJVPgtdgW4dxucurHFa06OKGjgoK8OREFA/edit#gid=1719181934"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bc42a35c-b04a-476c-bffe-ebd84d15409d",
   "metadata": {},
   "source": [
    "**Install packages**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cc51b8fc-80e9-47b9-a44d-e75f15f019f5",
   "metadata": {
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "XRADIO version 1.1.12a0 already installed.\n",
      "Directory containing xradio /Users/jsteeb/Dropbox/xradio/src/xradio\n"
     ]
    }
   ],
   "source": [
    "from importlib.metadata import version\n",
    "import os\n",
    "\n",
    "try:\n",
    "    import xradio\n",
    "\n",
    "    print(\"XRADIO version\", version(\"xradio\"), \"already installed.\")\n",
    "except ImportError as e:\n",
    "    print(e)\n",
    "    print(\"Installing XRADIO\")\n",
    "\n",
    "    os.system(\"pip install xradio\")\n",
    "\n",
    "    import xradio\n",
    "\n",
    "    print(\"xradio version\", version(\"xradio\"), \" installed.\")\n",
    "\n",
    "\n",
    "print(\"Directory containing xradio\", os.path.dirname(xradio.__file__))\n",
    "\n",
    "# These are the three API functions that are currently supported\n",
    "from xradio.image import load_image, open_image, write_image"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e8e79e16",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[\u001b[38;2;128;05;128m2026-01-21 09:12:18,290\u001b[0m] \u001b[38;2;50;50;205m    INFO\u001b[0m\u001b[38;2;112;128;144m    viperlog: \u001b[0m Module path: \u001b[38;2;50;50;205m/Users/jsteeb/miniforge3/envs/timg/lib/python3.13/site-packages/toolviper\u001b[0m \n",
      "[\u001b[38;2;128;05;128m2026-01-21 09:12:18,293\u001b[0m] \u001b[38;2;255;160;0m WARNING\u001b[0m\u001b[38;2;112;128;144m    viperlog: \u001b[0m It is recommended that the local cache directory be set using the \u001b[38;2;50;50;205mdask_local_dir\u001b[0m parameter. \n",
      "[\u001b[38;2;128;05;128m2026-01-21 09:12:19,099\u001b[0m] \u001b[38;2;50;50;205m    INFO\u001b[0m\u001b[38;2;112;128;144m    viperlog: \u001b[0m Client <MenrvaClient: 'tcp://127.0.0.1:50088' processes=4 threads=4, memory=14.90 GiB> \n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">MenrvaClient-32414ea4-f6d3-11f0-bae9-80a9970f900d</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "\n",
       "        <tr>\n",
       "        \n",
       "            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n",
       "            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n",
       "        \n",
       "        </tr>\n",
       "\n",
       "        \n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\"></td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        </table>\n",
       "\n",
       "        \n",
       "\n",
       "        \n",
       "            <details>\n",
       "            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n",
       "            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n",
       "    </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">88e4d664</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Workers:</strong> 4\n",
       "                </td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total threads:</strong> 4\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total memory:</strong> 14.90 GiB\n",
       "                </td>\n",
       "            </tr>\n",
       "            \n",
       "            <tr>\n",
       "    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n",
       "    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n",
       "</tr>\n",
       "\n",
       "            \n",
       "        </table>\n",
       "\n",
       "        <details>\n",
       "            <summary style=\"margin-bottom: 20px;\">\n",
       "                <h3 style=\"display: inline;\">Scheduler Info</h3>\n",
       "            </summary>\n",
       "\n",
       "            <div style=\"\">\n",
       "    <div>\n",
       "        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n",
       "        <div style=\"margin-left: 48px;\">\n",
       "            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n",
       "            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-f1207c7f-5540-4faa-b3bf-aabb36bdbf03</p>\n",
       "            <table style=\"width: 100%; text-align: left;\">\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Comm:</strong> tcp://127.0.0.1:50088\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Workers:</strong> 4 \n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total threads:</strong> 4\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Started:</strong> Just now\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total memory:</strong> 14.90 GiB\n",
       "                    </td>\n",
       "                </tr>\n",
       "            </table>\n",
       "        </div>\n",
       "    </div>\n",
       "\n",
       "    <details style=\"margin-left: 48px;\">\n",
       "        <summary style=\"margin-bottom: 20px;\">\n",
       "            <h3 style=\"display: inline;\">Workers</h3>\n",
       "        </summary>\n",
       "\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:50099\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:50102/status\" target=\"_blank\">http://127.0.0.1:50102/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 3.73 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:50091\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /var/folders/b7/dx896v1x4yjb9v6rvs_n2hs00000gp/T/dask-scratch-space/worker-7snzal7v\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks executing: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in memory: </strong> \n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks ready: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in flight: </strong>\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>CPU usage:</strong> 0.0%\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Last seen: </strong> Just now\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory usage: </strong> 68.95 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Spilled bytes: </strong> 0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Read bytes: </strong> 4.24 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Write bytes: </strong> 0.0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:50101\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:50104/status\" target=\"_blank\">http://127.0.0.1:50104/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 3.73 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:50093\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /var/folders/b7/dx896v1x4yjb9v6rvs_n2hs00000gp/T/dask-scratch-space/worker-znyny86k\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks executing: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in memory: </strong> \n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks ready: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in flight: </strong>\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>CPU usage:</strong> 0.0%\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Last seen: </strong> Just now\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory usage: </strong> 68.58 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Spilled bytes: </strong> 0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Read bytes: </strong> 5.42 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Write bytes: </strong> 0.0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 2</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:50100\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:50105/status\" target=\"_blank\">http://127.0.0.1:50105/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 3.73 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:50095\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /var/folders/b7/dx896v1x4yjb9v6rvs_n2hs00000gp/T/dask-scratch-space/worker-c81r494u\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks executing: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in memory: </strong> \n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks ready: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in flight: </strong>\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>CPU usage:</strong> 0.0%\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Last seen: </strong> Just now\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory usage: </strong> 67.47 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Spilled bytes: </strong> 0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Read bytes: </strong> 6.54 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Write bytes: </strong> 0.0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 3</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:50108\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:50109/status\" target=\"_blank\">http://127.0.0.1:50109/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 3.73 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:50097\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /var/folders/b7/dx896v1x4yjb9v6rvs_n2hs00000gp/T/dask-scratch-space/worker-25tqprq4\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks executing: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in memory: </strong> \n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks ready: </strong> \n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Tasks in flight: </strong>\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>CPU usage:</strong> 0.0%\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Last seen: </strong> Just now\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory usage: </strong> 68.61 MiB\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Spilled bytes: </strong> 0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Read bytes: </strong> 0.0 B\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Write bytes: </strong> 0.0 B\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "\n",
       "    </details>\n",
       "</div>\n",
       "\n",
       "        </details>\n",
       "    </div>\n",
       "</div>\n",
       "            </details>\n",
       "        \n",
       "\n",
       "    </div>\n",
       "</div>"
      ],
      "text/plain": [
       "<MenrvaClient: 'tcp://127.0.0.1:50088' processes=4 threads=4, memory=14.90 GiB>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from toolviper.dask.client import local_client\n",
    "\n",
    "viper_client = local_client(cores=4, memory_limit=\"4GB\")\n",
    "viper_client"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6478c80-e036-4902-ba84-d67ea0619495",
   "metadata": {},
   "source": [
    "**Imports**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2c900d51-c591-4949-a14a-978f35663c72",
   "metadata": {
    "scrolled": true,
    "tags": []
   },
   "outputs": [],
   "source": [
    "import xradio\n",
    "\n",
    "# These are the three API functions that are currently supported\n",
    "from xradio.image import load_image, open_image, write_image"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e086436-63b2-416f-b4ad-ef5fd9f55529",
   "metadata": {},
   "source": [
    "## Download image to be used"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c440abc6-f487-4707-993e-98269ac65d55",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[\u001b[38;2;128;05;128m2026-01-21 09:12:19,126\u001b[0m] \u001b[38;2;50;50;205m    INFO\u001b[0m\u001b[38;2;112;128;144m    viperlog: \u001b[0m Downloading from [cloudflare] .... \n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">                     \n",
       " <span style=\"font-weight: bold\"> Download List     </span> \n",
       " â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ \n",
       "  <span style=\"color: #800080; text-decoration-color: #800080\">demo_simulated.im</span>  \n",
       "                     \n",
       "</pre>\n"
      ],
      "text/plain": [
       "                     \n",
       " \u001b[1m \u001b[0m\u001b[1mDownload List    \u001b[0m\u001b[1m \u001b[0m \n",
       " â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ \n",
       "  \u001b[35mdemo_simulated.im\u001b[0m  \n",
       "                     \n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[\u001b[38;2;128;05;128m2026-01-21 09:12:19,130\u001b[0m] \u001b[38;2;50;50;205m    INFO\u001b[0m\u001b[38;2;112;128;144m    viperlog: \u001b[0m File exists: demo_simulated.im \n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "884e25812ee24b1e990e4c437b6204e5",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Output()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n"
      ],
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import toolviper\n",
    "toolviper.utils.data.download(\"demo_simulated.im\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "818bbad0-bbb5-401d-96f3-8de5f4f11252",
   "metadata": {
    "tags": []
   },
   "source": [
    "## Convert CASA image to XDS"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "192235fd-f535-48c4-bc27-d355708c1a8e",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true
   },
   "source": [
    "### Supported images, casa, FITS, zarr\n",
    "Supported image formats that can be read\n",
    "by this method are casacore, FITS, and zarr. Here \"supported\" means\n",
    "some images in these formats are supported. The parameter space of\n",
    "input image formats that has been investigated is still limited. For\n",
    "example, aperture (*uv* plane) images are not yet supported, but given\n",
    "their importance in applications like *feather* which make heavy use\n",
    "of fourier transforms, support for them will likely be added sooner\n",
    "rather than later. Note that images containing Taylor terms will also\n",
    "be supported at some point.\n",
    "\n",
    "### Always 5-D, time, frequency, polarization, l/u, m/v dimensions\n",
    "Valid image set XDSes always have five dimensions: time, frequency, polarization,\n",
    "l (or u),\n",
    "and m (or v). Images that have multiple (per-plane) beams will also have\n",
    "a beam_param dimension. The dimensions will follow this ordering\n",
    "in most, and maybe all, cases. That's still TBD. In addition, it is possible,\n",
    "from an Xarray standpoint, to have both astronomical images and their fourier\n",
    "counterparts in the same Dataset. In this case there will be l, m, u, and v\n",
    "dimensions. Invididual images (astronomical and fourier) will depend upon\n",
    "only the coordinates they require. Whether RADPS will support such image sets\n",
    "is still TBD.\n",
    "\n",
    "###  Coordinates vs dimensions\n",
    "Note that in xarray jargon, a dimension and a coordinate are\n",
    "different constructs. Coordinates are \"higher level\" in that they are\n",
    "always functions of dimensions. I think of dimensions as orthogonal\n",
    "axes in a Cartesian coordinate system. They are essentially pixel coordinate\n",
    "axes. Coordinates, however, do not\n",
    "have to conform to this constraint, which is important for curved\n",
    "surfaces like the sky. Think of RA and Dec, which are both functions\n",
    "of the two direction pixel coordinates, (l, m). So, xarray coordinates\n",
    "are akin to CASA's world coordinates. In addition, coordinates can have\n",
    "labels as values rather than numerical values. So, think of the polarization\n",
    "axis. In this case, the coordinate values are labels like \"I\", \"Q\", \"U\", \"V\" etc."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ed3f0958-0c2c-4980-8eaf-e3aa0334c1eb",
   "metadata": {},
   "source": [
    "### open_image, create image xarray dataset (XDS)\n",
    "The **open_image** function will convert an image in a supported format\n",
    "to an image XDS (xarray.Dataset)."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6675b86-468b-4254-9a88-707e6de3b399",
   "metadata": {},
   "source": [
    "###  Output dask array chunksize specified as a dict to open_image()\n",
    "The chunk size of the output dask pixel array can be specified using\n",
    "a dictionary in which the supported keys are 'l' (corresponding to\n",
    "the longitude like dimension), 'm' (corresponding to the latitude like\n",
    "dimension), 'frequency' (corresponding to the spectral dimension), 'polarization'\n",
    "(corresponding to the polarization dimension), and 'time'\n",
    "(corresponding to the temporal dimension). The values correspond to\n",
    "the chunk length along that axis. If any of these keys are absent, the\n",
    "length of a chunk in that dimension will be equal to the number of\n",
    "pixels along that axis. Specified keys for which there are no\n",
    "corresponding axes in the CASA image are silently ignored. 'u' and 'v'\n",
    "may be substituted for 'l' and 'm' which is useful in the case of\n",
    "aperture (Fourier plane) images, when support for those has been added."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f102fb46-76f9-47f1-9652-ffa03f2bbac7",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Successful readonly open of default-locked table demo_simulated.im: 1 columns, 1 rows\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 20MB\n",
       "Dimensions:              (time: 1, frequency: 50, polarization: 4, l: 200,\n",
       "                          m: 100, beam_params_label: 3)\n",
       "Coordinates:\n",
       "  * time                 (time) float64 8B 5.154e+04\n",
       "  * frequency            (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization         (polarization) &lt;U1 16B &#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;\n",
       "  * l                    (l) float64 2kB 0.02909 0.0288 ... -0.02851 -0.0288\n",
       "  * m                    (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "  * beam_params_label    (beam_params_label) &lt;U5 60B &#x27;major&#x27; &#x27;minor&#x27; &#x27;pa&#x27;\n",
       "    velocity             (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "    right_ascension      (l, m) float64 160kB 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination          (l, m) float64 160kB -0.01454 -0.01425 ... 0.01425\n",
       "Data variables:\n",
       "    SKY                  (time, frequency, polarization, l, m) float32 16MB dask.array&lt;chunksize=(1, 5, 4, 40, 20), meta=np.ndarray&gt;\n",
       "    BEAM_FIT_PARAMS_SKY  (time, frequency, polarization, beam_params_label) float64 5kB dask.array&lt;chunksize=(1, 50, 4, 3), meta=np.ndarray&gt;\n",
       "    FLAG_SKY             (time, frequency, polarization, l, m) bool 4MB dask.array&lt;chunksize=(1, 5, 4, 40, 20), meta=np.ndarray&gt;\n",
       "Attributes:\n",
       "    coordinate_system_info:  {&#x27;reference_direction&#x27;: {&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;fk5...\n",
       "    type:                    image_dataset\n",
       "    data_groups:             {&#x27;base&#x27;: {&#x27;sky&#x27;: &#x27;SKY&#x27;, &#x27;beam_fit_params_sky&#x27;: &#x27;...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-252ca15e-386c-4b2d-a77c-c34b09e4d959' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-252ca15e-386c-4b2d-a77c-c34b09e4d959' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>frequency</span>: 50</li><li><span class='xr-has-index'>polarization</span>: 4</li><li><span class='xr-has-index'>l</span>: 200</li><li><span class='xr-has-index'>m</span>: 100</li><li><span class='xr-has-index'>beam_params_label</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d6a23bc1-f082-48b3-b42c-e4df6b10f463' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d6a23bc1-f082-48b3-b42c-e4df6b10f463' class='xr-section-summary' >Coordinates: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.154e+04</div><input id='attrs-8cc4da9d-4d19-453f-9a09-f83e44cc30cf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8cc4da9d-4d19-453f-9a09-f83e44cc30cf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b459630-e69e-409a-8201-61fda949b5ee' class='xr-var-data-in' type='checkbox'><label for='data-1b459630-e69e-409a-8201-61fda949b5ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div><div class='xr-var-data'><pre>array([51544.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-ae8848e6-34c9-436c-a898-56f5239e1b2e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ae8848e6-34c9-436c-a898-56f5239e1b2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f6fce50-eab8-4c75-8b97-4c5b58b8362e' class='xr-var-data-in' type='checkbox'><label for='data-4f6fce50-eab8-4c75-8b97-4c5b58b8362e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>polarization</span></div><div class='xr-var-dims'>(polarization)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</div><input id='attrs-381a8cd0-ff70-47f8-ad09-0ed93f663198' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-381a8cd0-ff70-47f8-ad09-0ed93f663198' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4431a526-4508-4b2d-9d8c-0ee202f9c5be' class='xr-var-data-in' type='checkbox'><label for='data-4431a526-4508-4b2d-9d8c-0ee202f9c5be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>l</span></div><div class='xr-var-dims'>(l)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02909 0.0288 ... -0.02851 -0.0288</div><input id='attrs-4c1bf2f2-8bfb-41e3-ab3c-1830a10293e3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c1bf2f2-8bfb-41e3-ab3c-1830a10293e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24a48eba-5d19-4c77-9fa1-fce9e6f93fdc' class='xr-var-data-in' type='checkbox'><label for='data-24a48eba-5d19-4c77-9fa1-fce9e6f93fdc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>l is the angle measured from the reference direction to the east. So l = x*cdelt, where x is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([ 0.029089,  0.028798,  0.028507,  0.028216,  0.027925,  0.027634,\n",
       "        0.027343,  0.027053,  0.026762,  0.026471,  0.02618 ,  0.025889,\n",
       "        0.025598,  0.025307,  0.025016,  0.024725,  0.024435,  0.024144,\n",
       "        0.023853,  0.023562,  0.023271,  0.02298 ,  0.022689,  0.022398,\n",
       "        0.022108,  0.021817,  0.021526,  0.021235,  0.020944,  0.020653,\n",
       "        0.020362,  0.020071,  0.01978 ,  0.01949 ,  0.019199,  0.018908,\n",
       "        0.018617,  0.018326,  0.018035,  0.017744,  0.017453,  0.017162,\n",
       "        0.016872,  0.016581,  0.01629 ,  0.015999,  0.015708,  0.015417,\n",
       "        0.015126,  0.014835,  0.014544,  0.014254,  0.013963,  0.013672,\n",
       "        0.013381,  0.01309 ,  0.012799,  0.012508,  0.012217,  0.011926,\n",
       "        0.011636,  0.011345,  0.011054,  0.010763,  0.010472,  0.010181,\n",
       "        0.00989 ,  0.009599,  0.009308,  0.009018,  0.008727,  0.008436,\n",
       "        0.008145,  0.007854,  0.007563,  0.007272,  0.006981,  0.00669 ,\n",
       "        0.0064  ,  0.006109,  0.005818,  0.005527,  0.005236,  0.004945,\n",
       "        0.004654,  0.004363,  0.004072,  0.003782,  0.003491,  0.0032  ,\n",
       "        0.002909,  0.002618,  0.002327,  0.002036,  0.001745,  0.001454,\n",
       "        0.001164,  0.000873,  0.000582,  0.000291,  0.      , -0.000291,\n",
       "       -0.000582, -0.000873, -0.001164, -0.001454, -0.001745, -0.002036,\n",
       "       -0.002327, -0.002618, -0.002909, -0.0032  , -0.003491, -0.003782,\n",
       "       -0.004072, -0.004363, -0.004654, -0.004945, -0.005236, -0.005527,\n",
       "       -0.005818, -0.006109, -0.0064  , -0.00669 , -0.006981, -0.007272,\n",
       "       -0.007563, -0.007854, -0.008145, -0.008436, -0.008727, -0.009018,\n",
       "       -0.009308, -0.009599, -0.00989 , -0.010181, -0.010472, -0.010763,\n",
       "       -0.011054, -0.011345, -0.011636, -0.011926, -0.012217, -0.012508,\n",
       "       -0.012799, -0.01309 , -0.013381, -0.013672, -0.013963, -0.014254,\n",
       "       -0.014544, -0.014835, -0.015126, -0.015417, -0.015708, -0.015999,\n",
       "       -0.01629 , -0.016581, -0.016872, -0.017162, -0.017453, -0.017744,\n",
       "       -0.018035, -0.018326, -0.018617, -0.018908, -0.019199, -0.01949 ,\n",
       "       -0.01978 , -0.020071, -0.020362, -0.020653, -0.020944, -0.021235,\n",
       "       -0.021526, -0.021817, -0.022108, -0.022398, -0.022689, -0.02298 ,\n",
       "       -0.023271, -0.023562, -0.023853, -0.024144, -0.024435, -0.024725,\n",
       "       -0.025016, -0.025307, -0.025598, -0.025889, -0.02618 , -0.026471,\n",
       "       -0.026762, -0.027053, -0.027343, -0.027634, -0.027925, -0.028216,\n",
       "       -0.028507, -0.028798])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>m</span></div><div class='xr-var-dims'>(m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-01ebbaf4-5bc6-46b4-89c9-1496265fa481' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-01ebbaf4-5bc6-46b4-89c9-1496265fa481' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af1dfb83-0000-4c39-b396-782025a54fac' class='xr-var-data-in' type='checkbox'><label for='data-af1dfb83-0000-4c39-b396-782025a54fac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>m is the angle measured from the reference direction to the north. So m = y*cdelt, where y is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([-0.014544, -0.014254, -0.013963, -0.013672, -0.013381, -0.01309 ,\n",
       "       -0.012799, -0.012508, -0.012217, -0.011926, -0.011636, -0.011345,\n",
       "       -0.011054, -0.010763, -0.010472, -0.010181, -0.00989 , -0.009599,\n",
       "       -0.009308, -0.009018, -0.008727, -0.008436, -0.008145, -0.007854,\n",
       "       -0.007563, -0.007272, -0.006981, -0.00669 , -0.0064  , -0.006109,\n",
       "       -0.005818, -0.005527, -0.005236, -0.004945, -0.004654, -0.004363,\n",
       "       -0.004072, -0.003782, -0.003491, -0.0032  , -0.002909, -0.002618,\n",
       "       -0.002327, -0.002036, -0.001745, -0.001454, -0.001164, -0.000873,\n",
       "       -0.000582, -0.000291,  0.      ,  0.000291,  0.000582,  0.000873,\n",
       "        0.001164,  0.001454,  0.001745,  0.002036,  0.002327,  0.002618,\n",
       "        0.002909,  0.0032  ,  0.003491,  0.003782,  0.004072,  0.004363,\n",
       "        0.004654,  0.004945,  0.005236,  0.005527,  0.005818,  0.006109,\n",
       "        0.0064  ,  0.00669 ,  0.006981,  0.007272,  0.007563,  0.007854,\n",
       "        0.008145,  0.008436,  0.008727,  0.009018,  0.009308,  0.009599,\n",
       "        0.00989 ,  0.010181,  0.010472,  0.010763,  0.011054,  0.011345,\n",
       "        0.011636,  0.011926,  0.012217,  0.012508,  0.012799,  0.01309 ,\n",
       "        0.013381,  0.013672,  0.013963,  0.014254])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>beam_params_label</span></div><div class='xr-var-dims'>(beam_params_label)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;major&#x27; &#x27;minor&#x27; &#x27;pa&#x27;</div><input id='attrs-020eddcd-6f3f-403e-ae1f-cbdeefb9de7e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-020eddcd-6f3f-403e-ae1f-cbdeefb9de7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72b9b734-4550-4c23-bb9e-91161af06d7c' class='xr-var-data-in' type='checkbox'><label for='data-72b9b734-4550-4c23-bb9e-91161af06d7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;major&#x27;, &#x27;minor&#x27;, &#x27;pa&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-ab7d4e47-4315-4a8a-a6eb-12e0d65b4ff1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ab7d4e47-4315-4a8a-a6eb-12e0d65b4ff1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-493fe078-99eb-4fb9-a799-7ea5f149b25b' class='xr-var-data-in' type='checkbox'><label for='data-493fe078-99eb-4fb9-a799-7ea5f149b25b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>right_ascension</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0291 0.0291 ... 6.254 6.254</div><input id='attrs-b3267c0b-accf-4aab-a2d8-57b5fd217c92' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b3267c0b-accf-4aab-a2d8-57b5fd217c92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87372af5-6ade-4ad8-a3f9-3e56f5a1c3e8' class='xr-var-data-in' type='checkbox'><label for='data-87372af5-6ade-4ad8-a3f9-3e56f5a1c3e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>declination</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-974cab4e-2ff9-4826-9a85-7af56f35eb8f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-974cab4e-2ff9-4826-9a85-7af56f35eb8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22bfbbcf-d0f7-43d7-896f-5667d2e48203' class='xr-var-data-in' type='checkbox'><label for='data-22bfbbcf-d0f7-43d7-896f-5667d2e48203' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5ca9e3a4-067c-47dd-8af7-2ec5752d02a8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5ca9e3a4-067c-47dd-8af7-2ec5752d02a8' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SKY</span></div><div class='xr-var-dims'>(time, frequency, polarization, l, m)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 5, 4, 40, 20), meta=np.ndarray&gt;</div><input id='attrs-333e39d3-8a9f-45fb-8333-7aa7146a28af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-333e39d3-8a9f-45fb-8333-7aa7146a28af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88b9bfa4-7f75-4505-8f11-56282efafa92' class='xr-var-data-in' type='checkbox'><label for='data-88b9bfa4-7f75-4505-8f11-56282efafa92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>sky</dd><dt><span>units :</span></dt><dd>Jy/beam</dd><dt><span>telescope :</span></dt><dd>{&#x27;name&#x27;: &#x27;ALMA&#x27;, &#x27;direction&#x27;: {&#x27;attrs&#x27;: {&#x27;coordinate_system&#x27;: &#x27;geocentric&#x27;, &#x27;frame&#x27;: &#x27;ITRF&#x27;, &#x27;origin_object_name&#x27;: &#x27;earth&#x27;, &#x27;type&#x27;: &#x27;location&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;}, &#x27;data&#x27;: [-1.1825465955049892, -0.3994149869262738], &#x27;dims&#x27;: [&#x27;ellipsoid_dir_label&#x27;], &#x27;coords&#x27;: {&#x27;ellipsoid_dir_label&#x27;: {&#x27;dims&#x27;: [&#x27;ellipsoid_dir_label&#x27;], &#x27;data&#x27;: [&#x27;lon&#x27;, &#x27;lat&#x27;]}}}, &#x27;distance&#x27;: {&#x27;attrs&#x27;: {&#x27;coordinate_system&#x27;: &#x27;geocentric&#x27;, &#x27;frame&#x27;: &#x27;ITRF&#x27;, &#x27;origin_object_name&#x27;: &#x27;earth&#x27;, &#x27;type&#x27;: &#x27;location&#x27;, &#x27;units&#x27;: &#x27;m&#x27;}, &#x27;data&#x27;: [6379946.01326443], &#x27;dims&#x27;: [&#x27;ellipsoid_dis_label&#x27;], &#x27;coords&#x27;: {&#x27;ellipsoid_dis_label&#x27;: {&#x27;dims&#x27;: [&#x27;ellipsoid_dis_label&#x27;], &#x27;data&#x27;: [&#x27;dist&#x27;]}}}}</dd><dt><span>observer :</span></dt><dd>Karl Jansky</dd><dt><span>obsdate :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;d&#x27;, &#x27;scale&#x27;: &#x27;utc&#x27;, &#x27;format&#x27;: &#x27;mjd&#x27;, &#x27;type&#x27;: &#x27;time&#x27;}, &#x27;data&#x27;: 51544.00000000116, &#x27;dims&#x27;: []}</dd><dt><span>pointing_center :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;fk5&#x27;, &#x27;type&#x27;: &#x27;sky_coord&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;}, &#x27;data&#x27;: [0.0, 0.0], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;, &#x27;coords&#x27;: {&#x27;sky_dir_label&#x27;: {&#x27;data&#x27;: [&#x27;ra&#x27;, &#x27;dec&#x27;], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;}}}</dd><dt><span>object_name :</span></dt><dd></dd><dt><span>user :</span></dt><dd>{}</dd><dt><span>description :</span></dt><dd>None</dd><dt><span>beam_fit_params :</span></dt><dd>BEAM_FIT_PARAMS_SKY</dd></dl></div><div class='xr-var-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 15.26 MiB </td>\n",
       "                        <td> 62.50 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 200, 100) </td>\n",
       "                        <td> (1, 5, 4, 40, 20) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 250 chunks in 563 graph layers </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> float32 numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"351\" height=\"187\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"42\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"4\" y1=\"0\" x2=\"4\" y2=\"25\" />\n",
       "  <line x1=\"8\" y1=\"0\" x2=\"8\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"17\" y1=\"0\" x2=\"17\" y2=\"25\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"25\" />\n",
       "  <line x1=\"34\" y1=\"0\" x2=\"34\" y2=\"25\" />\n",
       "  <line x1=\"38\" y1=\"0\" x2=\"38\" y2=\"25\" />\n",
       "  <line x1=\"42\" y1=\"0\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 42.89879552186203,0.0 42.89879552186203,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"21.449398\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >50</text>\n",
       "  <text x=\"62.898796\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,62.898796,12.706308)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"112\" y1=\"24\" x2=\"129\" y2=\"41\" />\n",
       "  <line x1=\"112\" y1=\"48\" x2=\"129\" y2=\"65\" />\n",
       "  <line x1=\"112\" y1=\"72\" x2=\"129\" y2=\"89\" />\n",
       "  <line x1=\"112\" y1=\"96\" x2=\"129\" y2=\"113\" />\n",
       "  <line x1=\"112\" y1=\"120\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 129.0768405943964,17.076840594396398 129.0768405943964,137.0768405943964 112.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"172\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"124\" y1=\"0\" x2=\"141\" y2=\"17\" />\n",
       "  <line x1=\"136\" y1=\"0\" x2=\"153\" y2=\"17\" />\n",
       "  <line x1=\"148\" y1=\"0\" x2=\"165\" y2=\"17\" />\n",
       "  <line x1=\"160\" y1=\"0\" x2=\"177\" y2=\"17\" />\n",
       "  <line x1=\"172\" y1=\"0\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 172.0,0.0 189.0768405943964,17.076840594396398 129.0768405943964,17.076840594396398\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"41\" x2=\"189\" y2=\"41\" />\n",
       "  <line x1=\"129\" y1=\"65\" x2=\"189\" y2=\"65\" />\n",
       "  <line x1=\"129\" y1=\"89\" x2=\"189\" y2=\"89\" />\n",
       "  <line x1=\"129\" y1=\"113\" x2=\"189\" y2=\"113\" />\n",
       "  <line x1=\"129\" y1=\"137\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"141\" y1=\"17\" x2=\"141\" y2=\"137\" />\n",
       "  <line x1=\"153\" y1=\"17\" x2=\"153\" y2=\"137\" />\n",
       "  <line x1=\"165\" y1=\"17\" x2=\"165\" y2=\"137\" />\n",
       "  <line x1=\"177\" y1=\"17\" x2=\"177\" y2=\"137\" />\n",
       "  <line x1=\"189\" y1=\"17\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"129.0768405943964,17.076840594396398 189.0768405943964,17.076840594396398 189.0768405943964,137.0768405943964 129.0768405943964,137.0768405943964\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"159.076841\" y=\"157.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >100</text>\n",
       "  <text x=\"209.076841\" y=\"77.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,209.076841,77.076841)\">200</text>\n",
       "  <text x=\"110.538420\" y=\"148.538420\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,110.538420,148.538420)\">4</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>BEAM_FIT_PARAMS_SKY</span></div><div class='xr-var-dims'>(time, frequency, polarization, beam_params_label)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 50, 4, 3), meta=np.ndarray&gt;</div><input id='attrs-81dfc6aa-04b5-4405-86e2-033bdc4ee658' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-81dfc6aa-04b5-4405-86e2-033bdc4ee658' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2cb70ed-1ad4-472d-a159-c6d0e6cee2af' class='xr-var-data-in' type='checkbox'><label for='data-b2cb70ed-1ad4-472d-a159-c6d0e6cee2af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>rad</dd><dt><span>type :</span></dt><dd>beam_fit_params_sky</dd></dl></div><div class='xr-var-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 4.69 kiB </td>\n",
       "                        <td> 4.69 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 3) </td>\n",
       "                        <td> (1, 50, 4, 3) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 1 chunks in 1 graph layer </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"354\" height=\"157\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"29\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"29\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"29\" y1=\"0\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 29.030629010473877,0.0 29.030629010473877,29.030629010473877 0.0,29.030629010473877\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"14.515315\" y=\"49.030629\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >1</text>\n",
       "  <text x=\"49.030629\" y=\"14.515315\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,49.030629,14.515315)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"99\" y1=\"37\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"99\" y2=\"37\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 169.58823529411765,70.58823529411765 169.58823529411765,107.91480899349406 99.0,37.326573699376404\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"134\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"134\" y1=\"0\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 134.61261971641667,0.0 205.20085501053433,70.58823529411765 169.58823529411765,70.58823529411765\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"107\" x2=\"205\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"205\" y1=\"70\" x2=\"205\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"169.58823529411765,70.58823529411765 205.20085501053433,70.58823529411765 205.20085501053433,107.91480899349406 169.58823529411765,107.91480899349406\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"187.394545\" y=\"127.914809\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >3</text>\n",
       "  <text x=\"225.200855\" y=\"89.251522\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,225.200855,89.251522)\">4</text>\n",
       "  <text x=\"124.294118\" y=\"92.620691\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,124.294118,92.620691)\">50</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FLAG_SKY</span></div><div class='xr-var-dims'>(time, frequency, polarization, l, m)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 5, 4, 40, 20), meta=np.ndarray&gt;</div><input id='attrs-81275de5-5fa3-41d2-bf18-8f036ae4fef6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-81275de5-5fa3-41d2-bf18-8f036ae4fef6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d39aae71-83f5-461d-9bc6-ee20ae373094' class='xr-var-data-in' type='checkbox'><label for='data-d39aae71-83f5-461d-9bc6-ee20ae373094' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>flag</dd></dl></div><div class='xr-var-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 3.81 MiB </td>\n",
       "                        <td> 15.62 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 200, 100) </td>\n",
       "                        <td> (1, 5, 4, 40, 20) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 250 chunks in 564 graph layers </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> bool numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"351\" height=\"187\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"42\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"4\" y1=\"0\" x2=\"4\" y2=\"25\" />\n",
       "  <line x1=\"8\" y1=\"0\" x2=\"8\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"17\" y1=\"0\" x2=\"17\" y2=\"25\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"25\" />\n",
       "  <line x1=\"34\" y1=\"0\" x2=\"34\" y2=\"25\" />\n",
       "  <line x1=\"38\" y1=\"0\" x2=\"38\" y2=\"25\" />\n",
       "  <line x1=\"42\" y1=\"0\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 42.89879552186203,0.0 42.89879552186203,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"21.449398\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >50</text>\n",
       "  <text x=\"62.898796\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,62.898796,12.706308)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"112\" y1=\"24\" x2=\"129\" y2=\"41\" />\n",
       "  <line x1=\"112\" y1=\"48\" x2=\"129\" y2=\"65\" />\n",
       "  <line x1=\"112\" y1=\"72\" x2=\"129\" y2=\"89\" />\n",
       "  <line x1=\"112\" y1=\"96\" x2=\"129\" y2=\"113\" />\n",
       "  <line x1=\"112\" y1=\"120\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 129.0768405943964,17.076840594396398 129.0768405943964,137.0768405943964 112.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"172\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"124\" y1=\"0\" x2=\"141\" y2=\"17\" />\n",
       "  <line x1=\"136\" y1=\"0\" x2=\"153\" y2=\"17\" />\n",
       "  <line x1=\"148\" y1=\"0\" x2=\"165\" y2=\"17\" />\n",
       "  <line x1=\"160\" y1=\"0\" x2=\"177\" y2=\"17\" />\n",
       "  <line x1=\"172\" y1=\"0\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 172.0,0.0 189.0768405943964,17.076840594396398 129.0768405943964,17.076840594396398\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"41\" x2=\"189\" y2=\"41\" />\n",
       "  <line x1=\"129\" y1=\"65\" x2=\"189\" y2=\"65\" />\n",
       "  <line x1=\"129\" y1=\"89\" x2=\"189\" y2=\"89\" />\n",
       "  <line x1=\"129\" y1=\"113\" x2=\"189\" y2=\"113\" />\n",
       "  <line x1=\"129\" y1=\"137\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"141\" y1=\"17\" x2=\"141\" y2=\"137\" />\n",
       "  <line x1=\"153\" y1=\"17\" x2=\"153\" y2=\"137\" />\n",
       "  <line x1=\"165\" y1=\"17\" x2=\"165\" y2=\"137\" />\n",
       "  <line x1=\"177\" y1=\"17\" x2=\"177\" y2=\"137\" />\n",
       "  <line x1=\"189\" y1=\"17\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"129.0768405943964,17.076840594396398 189.0768405943964,17.076840594396398 189.0768405943964,137.0768405943964 129.0768405943964,137.0768405943964\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"159.076841\" y=\"157.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >100</text>\n",
       "  <text x=\"209.076841\" y=\"77.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,209.076841,77.076841)\">200</text>\n",
       "  <text x=\"110.538420\" y=\"148.538420\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,110.538420,148.538420)\">4</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-9b5c3a07-9935-4dd7-8df2-9973e67cc99d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9b5c3a07-9935-4dd7-8df2-9973e67cc99d' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>coordinate_system_info :</span></dt><dd>{&#x27;reference_direction&#x27;: {&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;fk5&#x27;, &#x27;type&#x27;: &#x27;sky_coord&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;, &#x27;equinox&#x27;: &#x27;j2000.0&#x27;}, &#x27;data&#x27;: [0.0, 0.0], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;, &#x27;coords&#x27;: {&#x27;sky_dir_label&#x27;: {&#x27;data&#x27;: [&#x27;ra&#x27;, &#x27;dec&#x27;], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;}}}, &#x27;native_pole_direction&#x27;: {&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;NATIVE_PROJECTION&#x27;, &#x27;type&#x27;: &#x27;location&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;}, &#x27;data&#x27;: [3.141592653589793, 0.0], &#x27;dims&#x27;: &#x27;ellipsoid_dir_label&#x27;, &#x27;coords&#x27;: {&#x27;ellipsoid_dir_label&#x27;: {&#x27;data&#x27;: [&#x27;lon&#x27;, &#x27;lat&#x27;], &#x27;dims&#x27;: &#x27;ellipsoid_dir_label&#x27;}}}, &#x27;projection&#x27;: &#x27;SIN&#x27;, &#x27;projection_parameters&#x27;: [0.0, 0.0], &#x27;pixel_coordinate_transformation_matrix&#x27;: [[1.0, 0.0], [0.0, 1.0]]}</dd><dt><span>type :</span></dt><dd>image_dataset</dd><dt><span>data_groups :</span></dt><dd>{&#x27;base&#x27;: {&#x27;sky&#x27;: &#x27;SKY&#x27;, &#x27;beam_fit_params_sky&#x27;: &#x27;BEAM_FIT_PARAMS_SKY&#x27;, &#x27;flag&#x27;: &#x27;FLAG_SKY&#x27;}}</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.Dataset> Size: 20MB\n",
       "Dimensions:              (time: 1, frequency: 50, polarization: 4, l: 200,\n",
       "                          m: 100, beam_params_label: 3)\n",
       "Coordinates:\n",
       "  * time                 (time) float64 8B 5.154e+04\n",
       "  * frequency            (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization         (polarization) <U1 16B 'I' 'Q' 'U' 'V'\n",
       "  * l                    (l) float64 2kB 0.02909 0.0288 ... -0.02851 -0.0288\n",
       "  * m                    (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "  * beam_params_label    (beam_params_label) <U5 60B 'major' 'minor' 'pa'\n",
       "    velocity             (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "    right_ascension      (l, m) float64 160kB 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination          (l, m) float64 160kB -0.01454 -0.01425 ... 0.01425\n",
       "Data variables:\n",
       "    SKY                  (time, frequency, polarization, l, m) float32 16MB dask.array<chunksize=(1, 5, 4, 40, 20), meta=np.ndarray>\n",
       "    BEAM_FIT_PARAMS_SKY  (time, frequency, polarization, beam_params_label) float64 5kB dask.array<chunksize=(1, 50, 4, 3), meta=np.ndarray>\n",
       "    FLAG_SKY             (time, frequency, polarization, l, m) bool 4MB dask.array<chunksize=(1, 5, 4, 40, 20), meta=np.ndarray>\n",
       "Attributes:\n",
       "    coordinate_system_info:  {'reference_direction': {'attrs': {'frame': 'fk5...\n",
       "    type:                    image_dataset\n",
       "    data_groups:             {'base': {'sky': 'SKY', 'beam_fit_params_sky': '..."
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# polarization is not specified, so the length of the axis in this dimension\n",
    "# is equal to the number of pixels on the polarization axis, which is 4.\n",
    "imname = \"demo_simulated.im\"\n",
    "from xradio.image import load_image, open_image, write_image\n",
    "\n",
    "xds = open_image(store=imname, chunks={\"l\": 40, \"m\": 20, \"frequency\": 5})\n",
    "xds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "60a09ba4-0e12-4d1d-aa51-24b4e412a23a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "FrozenMappingWarningOnValuesAccess({'time': 1, 'frequency': 50, 'polarization': 4, 'l': 200, 'm': 100, 'beam_params_label': 3})"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.dims"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0406fb47-b8a3-4da6-a7f2-2b5f89aec9e9",
   "metadata": {
    "tags": []
   },
   "source": [
    "##  Data Variables"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "01916608-2a84-4b57-bd6f-a04bb2753518",
   "metadata": {},
   "source": [
    "### Data Variable: Pixel Values"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14c08efa-3e1a-4d17-8164-ddfddd6a7cec",
   "metadata": {},
   "source": [
    "The image pixel values are contained in the sky data variable."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "dc2c8ebf-f472-400b-89d3-489b0a3e74fb",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;SKY&#x27; (time: 1, frequency: 50, polarization: 4, l: 200, m: 100)&gt; Size: 16MB\n",
       "dask.array&lt;transpose, shape=(1, 50, 4, 200, 100), dtype=float32, chunksize=(1, 5, 4, 40, 20), chunktype=numpy.ndarray&gt;\n",
       "Coordinates:\n",
       "  * time             (time) float64 8B 5.154e+04\n",
       "  * frequency        (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "  * polarization     (polarization) &lt;U1 16B &#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    velocity         (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "Attributes:\n",
       "    type:             sky\n",
       "    units:            Jy/beam\n",
       "    telescope:        {&#x27;name&#x27;: &#x27;ALMA&#x27;, &#x27;direction&#x27;: {&#x27;attrs&#x27;: {&#x27;coordinate_sy...\n",
       "    observer:         Karl Jansky\n",
       "    obsdate:          {&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;d&#x27;, &#x27;scale&#x27;: &#x27;utc&#x27;, &#x27;format&#x27;: &#x27;mjd...\n",
       "    pointing_center:  {&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;fk5&#x27;, &#x27;type&#x27;: &#x27;sky_coord&#x27;, &#x27;units&#x27;...\n",
       "    object_name:      \n",
       "    user:             {}\n",
       "    description:      None\n",
       "    beam_fit_params:  BEAM_FIT_PARAMS_SKY</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;SKY&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>frequency</span>: 50</li><li><span class='xr-has-index'>polarization</span>: 4</li><li><span class='xr-has-index'>l</span>: 200</li><li><span class='xr-has-index'>m</span>: 100</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-073a912f-8943-47f3-bf64-3a1b2d55e757' class='xr-array-in' type='checkbox' checked><label for='section-073a912f-8943-47f3-bf64-3a1b2d55e757' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 5, 4, 40, 20), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 15.26 MiB </td>\n",
       "                        <td> 62.50 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 200, 100) </td>\n",
       "                        <td> (1, 5, 4, 40, 20) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 250 chunks in 563 graph layers </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> float32 numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"351\" height=\"187\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"42\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"4\" y1=\"0\" x2=\"4\" y2=\"25\" />\n",
       "  <line x1=\"8\" y1=\"0\" x2=\"8\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"17\" y1=\"0\" x2=\"17\" y2=\"25\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"25\" />\n",
       "  <line x1=\"34\" y1=\"0\" x2=\"34\" y2=\"25\" />\n",
       "  <line x1=\"38\" y1=\"0\" x2=\"38\" y2=\"25\" />\n",
       "  <line x1=\"42\" y1=\"0\" x2=\"42\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 42.89879552186203,0.0 42.89879552186203,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"21.449398\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >50</text>\n",
       "  <text x=\"62.898796\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,62.898796,12.706308)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"112\" y1=\"24\" x2=\"129\" y2=\"41\" />\n",
       "  <line x1=\"112\" y1=\"48\" x2=\"129\" y2=\"65\" />\n",
       "  <line x1=\"112\" y1=\"72\" x2=\"129\" y2=\"89\" />\n",
       "  <line x1=\"112\" y1=\"96\" x2=\"129\" y2=\"113\" />\n",
       "  <line x1=\"112\" y1=\"120\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 129.0768405943964,17.076840594396398 129.0768405943964,137.0768405943964 112.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"172\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"129\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"124\" y1=\"0\" x2=\"141\" y2=\"17\" />\n",
       "  <line x1=\"136\" y1=\"0\" x2=\"153\" y2=\"17\" />\n",
       "  <line x1=\"148\" y1=\"0\" x2=\"165\" y2=\"17\" />\n",
       "  <line x1=\"160\" y1=\"0\" x2=\"177\" y2=\"17\" />\n",
       "  <line x1=\"172\" y1=\"0\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"112.0,0.0 172.0,0.0 189.0768405943964,17.076840594396398 129.0768405943964,17.076840594396398\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"189\" y2=\"17\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"129\" y1=\"41\" x2=\"189\" y2=\"41\" />\n",
       "  <line x1=\"129\" y1=\"65\" x2=\"189\" y2=\"65\" />\n",
       "  <line x1=\"129\" y1=\"89\" x2=\"189\" y2=\"89\" />\n",
       "  <line x1=\"129\" y1=\"113\" x2=\"189\" y2=\"113\" />\n",
       "  <line x1=\"129\" y1=\"137\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"129\" y1=\"17\" x2=\"129\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"141\" y1=\"17\" x2=\"141\" y2=\"137\" />\n",
       "  <line x1=\"153\" y1=\"17\" x2=\"153\" y2=\"137\" />\n",
       "  <line x1=\"165\" y1=\"17\" x2=\"165\" y2=\"137\" />\n",
       "  <line x1=\"177\" y1=\"17\" x2=\"177\" y2=\"137\" />\n",
       "  <line x1=\"189\" y1=\"17\" x2=\"189\" y2=\"137\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"129.0768405943964,17.076840594396398 189.0768405943964,17.076840594396398 189.0768405943964,137.0768405943964 129.0768405943964,137.0768405943964\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"159.076841\" y=\"157.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >100</text>\n",
       "  <text x=\"209.076841\" y=\"77.076841\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,209.076841,77.076841)\">200</text>\n",
       "  <text x=\"110.538420\" y=\"148.538420\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,110.538420,148.538420)\">4</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></div></li><li class='xr-section-item'><input id='section-63d3fe06-4d1d-482a-9d64-6da99ae8c274' class='xr-section-summary-in' type='checkbox'  checked><label for='section-63d3fe06-4d1d-482a-9d64-6da99ae8c274' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.154e+04</div><input id='attrs-8e850d3c-7a55-4003-adb5-952e0f9cf889' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e850d3c-7a55-4003-adb5-952e0f9cf889' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04d895f0-1eb0-47a5-a6e0-f1c52741e926' class='xr-var-data-in' type='checkbox'><label for='data-04d895f0-1eb0-47a5-a6e0-f1c52741e926' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div><div class='xr-var-data'><pre>array([51544.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-cfa8bb98-8791-49f1-9636-7fe5b486a7e4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cfa8bb98-8791-49f1-9636-7fe5b486a7e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b85a5a1-6389-4a76-a478-a49108e97642' class='xr-var-data-in' type='checkbox'><label for='data-6b85a5a1-6389-4a76-a478-a49108e97642' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>polarization</span></div><div class='xr-var-dims'>(polarization)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</div><input id='attrs-55efe717-c724-45ae-9056-a6312daee1dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-55efe717-c724-45ae-9056-a6312daee1dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0ea509d-d5f7-4480-b766-762eca80f226' class='xr-var-data-in' type='checkbox'><label for='data-d0ea509d-d5f7-4480-b766-762eca80f226' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>l</span></div><div class='xr-var-dims'>(l)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02909 0.0288 ... -0.02851 -0.0288</div><input id='attrs-baf0937d-10aa-4f7d-8c31-b1d9df81f96f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-baf0937d-10aa-4f7d-8c31-b1d9df81f96f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac636fbf-ecc8-4593-9aa5-5825b89b8fbe' class='xr-var-data-in' type='checkbox'><label for='data-ac636fbf-ecc8-4593-9aa5-5825b89b8fbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>l is the angle measured from the reference direction to the east. So l = x*cdelt, where x is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([ 0.029089,  0.028798,  0.028507,  0.028216,  0.027925,  0.027634,\n",
       "        0.027343,  0.027053,  0.026762,  0.026471,  0.02618 ,  0.025889,\n",
       "        0.025598,  0.025307,  0.025016,  0.024725,  0.024435,  0.024144,\n",
       "        0.023853,  0.023562,  0.023271,  0.02298 ,  0.022689,  0.022398,\n",
       "        0.022108,  0.021817,  0.021526,  0.021235,  0.020944,  0.020653,\n",
       "        0.020362,  0.020071,  0.01978 ,  0.01949 ,  0.019199,  0.018908,\n",
       "        0.018617,  0.018326,  0.018035,  0.017744,  0.017453,  0.017162,\n",
       "        0.016872,  0.016581,  0.01629 ,  0.015999,  0.015708,  0.015417,\n",
       "        0.015126,  0.014835,  0.014544,  0.014254,  0.013963,  0.013672,\n",
       "        0.013381,  0.01309 ,  0.012799,  0.012508,  0.012217,  0.011926,\n",
       "        0.011636,  0.011345,  0.011054,  0.010763,  0.010472,  0.010181,\n",
       "        0.00989 ,  0.009599,  0.009308,  0.009018,  0.008727,  0.008436,\n",
       "        0.008145,  0.007854,  0.007563,  0.007272,  0.006981,  0.00669 ,\n",
       "        0.0064  ,  0.006109,  0.005818,  0.005527,  0.005236,  0.004945,\n",
       "        0.004654,  0.004363,  0.004072,  0.003782,  0.003491,  0.0032  ,\n",
       "        0.002909,  0.002618,  0.002327,  0.002036,  0.001745,  0.001454,\n",
       "        0.001164,  0.000873,  0.000582,  0.000291,  0.      , -0.000291,\n",
       "       -0.000582, -0.000873, -0.001164, -0.001454, -0.001745, -0.002036,\n",
       "       -0.002327, -0.002618, -0.002909, -0.0032  , -0.003491, -0.003782,\n",
       "       -0.004072, -0.004363, -0.004654, -0.004945, -0.005236, -0.005527,\n",
       "       -0.005818, -0.006109, -0.0064  , -0.00669 , -0.006981, -0.007272,\n",
       "       -0.007563, -0.007854, -0.008145, -0.008436, -0.008727, -0.009018,\n",
       "       -0.009308, -0.009599, -0.00989 , -0.010181, -0.010472, -0.010763,\n",
       "       -0.011054, -0.011345, -0.011636, -0.011926, -0.012217, -0.012508,\n",
       "       -0.012799, -0.01309 , -0.013381, -0.013672, -0.013963, -0.014254,\n",
       "       -0.014544, -0.014835, -0.015126, -0.015417, -0.015708, -0.015999,\n",
       "       -0.01629 , -0.016581, -0.016872, -0.017162, -0.017453, -0.017744,\n",
       "       -0.018035, -0.018326, -0.018617, -0.018908, -0.019199, -0.01949 ,\n",
       "       -0.01978 , -0.020071, -0.020362, -0.020653, -0.020944, -0.021235,\n",
       "       -0.021526, -0.021817, -0.022108, -0.022398, -0.022689, -0.02298 ,\n",
       "       -0.023271, -0.023562, -0.023853, -0.024144, -0.024435, -0.024725,\n",
       "       -0.025016, -0.025307, -0.025598, -0.025889, -0.02618 , -0.026471,\n",
       "       -0.026762, -0.027053, -0.027343, -0.027634, -0.027925, -0.028216,\n",
       "       -0.028507, -0.028798])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>m</span></div><div class='xr-var-dims'>(m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-223adfa5-0ac9-484e-a9fe-9d81469384e0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-223adfa5-0ac9-484e-a9fe-9d81469384e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac9012ab-aa08-4d3e-913a-b93ca07f39ed' class='xr-var-data-in' type='checkbox'><label for='data-ac9012ab-aa08-4d3e-913a-b93ca07f39ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>m is the angle measured from the reference direction to the north. So m = y*cdelt, where y is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([-0.014544, -0.014254, -0.013963, -0.013672, -0.013381, -0.01309 ,\n",
       "       -0.012799, -0.012508, -0.012217, -0.011926, -0.011636, -0.011345,\n",
       "       -0.011054, -0.010763, -0.010472, -0.010181, -0.00989 , -0.009599,\n",
       "       -0.009308, -0.009018, -0.008727, -0.008436, -0.008145, -0.007854,\n",
       "       -0.007563, -0.007272, -0.006981, -0.00669 , -0.0064  , -0.006109,\n",
       "       -0.005818, -0.005527, -0.005236, -0.004945, -0.004654, -0.004363,\n",
       "       -0.004072, -0.003782, -0.003491, -0.0032  , -0.002909, -0.002618,\n",
       "       -0.002327, -0.002036, -0.001745, -0.001454, -0.001164, -0.000873,\n",
       "       -0.000582, -0.000291,  0.      ,  0.000291,  0.000582,  0.000873,\n",
       "        0.001164,  0.001454,  0.001745,  0.002036,  0.002327,  0.002618,\n",
       "        0.002909,  0.0032  ,  0.003491,  0.003782,  0.004072,  0.004363,\n",
       "        0.004654,  0.004945,  0.005236,  0.005527,  0.005818,  0.006109,\n",
       "        0.0064  ,  0.00669 ,  0.006981,  0.007272,  0.007563,  0.007854,\n",
       "        0.008145,  0.008436,  0.008727,  0.009018,  0.009308,  0.009599,\n",
       "        0.00989 ,  0.010181,  0.010472,  0.010763,  0.011054,  0.011345,\n",
       "        0.011636,  0.011926,  0.012217,  0.012508,  0.012799,  0.01309 ,\n",
       "        0.013381,  0.013672,  0.013963,  0.014254])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-b27c7376-8258-4123-b39c-2374b0e73949' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b27c7376-8258-4123-b39c-2374b0e73949' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55f8b25b-b4a6-47db-9410-da0a3cabbd57' class='xr-var-data-in' type='checkbox'><label for='data-55f8b25b-b4a6-47db-9410-da0a3cabbd57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>right_ascension</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0291 0.0291 ... 6.254 6.254</div><input id='attrs-8d8ae50e-6eda-4278-a607-85080a39bc6d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d8ae50e-6eda-4278-a607-85080a39bc6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0cdd246-7c0e-4dcc-bc1f-89f5378a21d2' class='xr-var-data-in' type='checkbox'><label for='data-d0cdd246-7c0e-4dcc-bc1f-89f5378a21d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>declination</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-97ea0d23-ed1f-47f0-a2e6-9efcdb42178a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-97ea0d23-ed1f-47f0-a2e6-9efcdb42178a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e979104c-1db5-474c-a165-e7a96f8a7ea6' class='xr-var-data-in' type='checkbox'><label for='data-e979104c-1db5-474c-a165-e7a96f8a7ea6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ccca1ee5-b792-45f7-90aa-d1fdd6ed1dca' class='xr-section-summary-in' type='checkbox'  ><label for='section-ccca1ee5-b792-45f7-90aa-d1fdd6ed1dca' class='xr-section-summary' >Attributes: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>sky</dd><dt><span>units :</span></dt><dd>Jy/beam</dd><dt><span>telescope :</span></dt><dd>{&#x27;name&#x27;: &#x27;ALMA&#x27;, &#x27;direction&#x27;: {&#x27;attrs&#x27;: {&#x27;coordinate_system&#x27;: &#x27;geocentric&#x27;, &#x27;frame&#x27;: &#x27;ITRF&#x27;, &#x27;origin_object_name&#x27;: &#x27;earth&#x27;, &#x27;type&#x27;: &#x27;location&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;}, &#x27;data&#x27;: [-1.1825465955049892, -0.3994149869262738], &#x27;dims&#x27;: [&#x27;ellipsoid_dir_label&#x27;], &#x27;coords&#x27;: {&#x27;ellipsoid_dir_label&#x27;: {&#x27;dims&#x27;: [&#x27;ellipsoid_dir_label&#x27;], &#x27;data&#x27;: [&#x27;lon&#x27;, &#x27;lat&#x27;]}}}, &#x27;distance&#x27;: {&#x27;attrs&#x27;: {&#x27;coordinate_system&#x27;: &#x27;geocentric&#x27;, &#x27;frame&#x27;: &#x27;ITRF&#x27;, &#x27;origin_object_name&#x27;: &#x27;earth&#x27;, &#x27;type&#x27;: &#x27;location&#x27;, &#x27;units&#x27;: &#x27;m&#x27;}, &#x27;data&#x27;: [6379946.01326443], &#x27;dims&#x27;: [&#x27;ellipsoid_dis_label&#x27;], &#x27;coords&#x27;: {&#x27;ellipsoid_dis_label&#x27;: {&#x27;dims&#x27;: [&#x27;ellipsoid_dis_label&#x27;], &#x27;data&#x27;: [&#x27;dist&#x27;]}}}}</dd><dt><span>observer :</span></dt><dd>Karl Jansky</dd><dt><span>obsdate :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;d&#x27;, &#x27;scale&#x27;: &#x27;utc&#x27;, &#x27;format&#x27;: &#x27;mjd&#x27;, &#x27;type&#x27;: &#x27;time&#x27;}, &#x27;data&#x27;: 51544.00000000116, &#x27;dims&#x27;: []}</dd><dt><span>pointing_center :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;frame&#x27;: &#x27;fk5&#x27;, &#x27;type&#x27;: &#x27;sky_coord&#x27;, &#x27;units&#x27;: &#x27;rad&#x27;}, &#x27;data&#x27;: [0.0, 0.0], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;, &#x27;coords&#x27;: {&#x27;sky_dir_label&#x27;: {&#x27;data&#x27;: [&#x27;ra&#x27;, &#x27;dec&#x27;], &#x27;dims&#x27;: &#x27;sky_dir_label&#x27;}}}</dd><dt><span>object_name :</span></dt><dd></dd><dt><span>user :</span></dt><dd>{}</dd><dt><span>description :</span></dt><dd>None</dd><dt><span>beam_fit_params :</span></dt><dd>BEAM_FIT_PARAMS_SKY</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'SKY' (time: 1, frequency: 50, polarization: 4, l: 200, m: 100)> Size: 16MB\n",
       "dask.array<transpose, shape=(1, 50, 4, 200, 100), dtype=float32, chunksize=(1, 5, 4, 40, 20), chunktype=numpy.ndarray>\n",
       "Coordinates:\n",
       "  * time             (time) float64 8B 5.154e+04\n",
       "  * frequency        (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "  * polarization     (polarization) <U1 16B 'I' 'Q' 'U' 'V'\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    velocity         (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "Attributes:\n",
       "    type:             sky\n",
       "    units:            Jy/beam\n",
       "    telescope:        {'name': 'ALMA', 'direction': {'attrs': {'coordinate_sy...\n",
       "    observer:         Karl Jansky\n",
       "    obsdate:          {'attrs': {'units': 'd', 'scale': 'utc', 'format': 'mjd...\n",
       "    pointing_center:  {'attrs': {'frame': 'fk5', 'type': 'sky_coord', 'units'...\n",
       "    object_name:      \n",
       "    user:             {}\n",
       "    description:      None\n",
       "    beam_fit_params:  BEAM_FIT_PARAMS_SKY"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.SKY"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d83d3aa4-60bf-4856-b567-3a233d2ff1b2",
   "metadata": {},
   "source": [
    "###  Data Variable: Masks"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "053ab34a-8bb9-4c85-a095-23a1af6a648e",
   "metadata": {
    "tags": []
   },
   "source": [
    "**WARNING: \n",
    "The meaning of xradio image mask values follows the numpy masked array\n",
    "convention which is opposite to CASA, ie True means the pixel is good, \n",
    "False means it is bad**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46799d89-1806-471a-9a02-a684b41613cb",
   "metadata": {},
   "source": [
    "The active mask can be found in the xds 'active_mask' attr of the image (more on attributes later). The image associated with this ImageSet is SKY. An empty string indicates that no mask is active; that is, all pixels are considered \"good\". Our example\n",
    "image does have a mask, and it is stored in the MASK_0 data variable. xds data variables' names\n",
    "are by convention upper case, so when importing a casacore image, and mask names will be in all caps."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "d9d4bb24-2e79-4b64-8d6c-ec54d43e6ab3",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# active_mask = xds[\"SKY\"].attrs[\"active_mask\"]\n",
    "# active_mask"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c7a804fb-9d54-40c9-94b8-e0694b862cd0",
   "metadata": {},
   "source": [
    "Mask values are stored in the xds data variable named for the mask"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "000435c9-7dc4-49ba-a116-652134a776a7",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "#xds[active_mask]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af349555-67cb-47bc-9d21-d5bca171ab9a",
   "metadata": {},
   "source": [
    "Or, via XDS 'dot' notation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "02c5ad65-b5ed-4775-a8af-bfe61df24178",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "#xds.MASK_0"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9f59920b-3e04-4f34-af5f-ed30be6edb0f",
   "metadata": {
    "tags": []
   },
   "source": [
    "###  Data Variable: Multiple Beams"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9c7acebf-7aac-4e6d-95ca-864a2840649a",
   "metadata": {},
   "source": [
    "Beams are stored in the BEAM data variable. This includes a single global beam. In this case, the beam is replicated in each element of the BEARM array."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "8bf8ab33-b81d-4aed-add8-6eacd8b064e0",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;BEAM_FIT_PARAMS_SKY&#x27; (time: 1, frequency: 50,\n",
       "                                         polarization: 4, beam_params_label: 3)&gt; Size: 5kB\n",
       "dask.array&lt;array, shape=(1, 50, 4, 3), dtype=float64, chunksize=(1, 50, 4, 3), chunktype=numpy.ndarray&gt;\n",
       "Coordinates:\n",
       "  * time               (time) float64 8B 5.154e+04\n",
       "  * frequency          (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization       (polarization) &lt;U1 16B &#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;\n",
       "  * beam_params_label  (beam_params_label) &lt;U5 60B &#x27;major&#x27; &#x27;minor&#x27; &#x27;pa&#x27;\n",
       "    velocity           (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    units:    rad\n",
       "    type:     beam_fit_params_sky</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;BEAM_FIT_PARAMS_SKY&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>frequency</span>: 50</li><li><span class='xr-has-index'>polarization</span>: 4</li><li><span class='xr-has-index'>beam_params_label</span>: 3</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-315f8df1-497f-4d6a-a094-f98a3149021b' class='xr-array-in' type='checkbox' checked><label for='section-315f8df1-497f-4d6a-a094-f98a3149021b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 50, 4, 3), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 4.69 kiB </td>\n",
       "                        <td> 4.69 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 3) </td>\n",
       "                        <td> (1, 50, 4, 3) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 1 chunks in 1 graph layer </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"354\" height=\"157\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"29\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"29\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"29\" y1=\"0\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 29.030629010473877,0.0 29.030629010473877,29.030629010473877 0.0,29.030629010473877\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"14.515315\" y=\"49.030629\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >1</text>\n",
       "  <text x=\"49.030629\" y=\"14.515315\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,49.030629,14.515315)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"99\" y1=\"37\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"99\" y2=\"37\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 169.58823529411765,70.58823529411765 169.58823529411765,107.91480899349406 99.0,37.326573699376404\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"134\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"134\" y1=\"0\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 134.61261971641667,0.0 205.20085501053433,70.58823529411765 169.58823529411765,70.58823529411765\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"205\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"107\" x2=\"205\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"205\" y1=\"70\" x2=\"205\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"169.58823529411765,70.58823529411765 205.20085501053433,70.58823529411765 205.20085501053433,107.91480899349406 169.58823529411765,107.91480899349406\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"187.394545\" y=\"127.914809\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >3</text>\n",
       "  <text x=\"225.200855\" y=\"89.251522\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,225.200855,89.251522)\">4</text>\n",
       "  <text x=\"124.294118\" y=\"92.620691\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,124.294118,92.620691)\">50</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></div></li><li class='xr-section-item'><input id='section-c01b88f6-f85b-4490-bb43-7aeb896a46fc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c01b88f6-f85b-4490-bb43-7aeb896a46fc' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.154e+04</div><input id='attrs-cf2d713a-e14f-41b5-97b2-a777e3ecf6aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cf2d713a-e14f-41b5-97b2-a777e3ecf6aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a341b3ca-78b9-4685-b2ac-2c827506bd3d' class='xr-var-data-in' type='checkbox'><label for='data-a341b3ca-78b9-4685-b2ac-2c827506bd3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div><div class='xr-var-data'><pre>array([51544.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-2e11c65d-3e6f-4724-a50b-fc7da3e114f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e11c65d-3e6f-4724-a50b-fc7da3e114f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68df2eb4-a282-4029-bd28-d5b49f9778fc' class='xr-var-data-in' type='checkbox'><label for='data-68df2eb4-a282-4029-bd28-d5b49f9778fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>polarization</span></div><div class='xr-var-dims'>(polarization)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</div><input id='attrs-4fea3d22-cc29-4454-b175-4906cebdf46e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4fea3d22-cc29-4454-b175-4906cebdf46e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ce8383b2-a375-49e0-856f-f820e03934e7' class='xr-var-data-in' type='checkbox'><label for='data-ce8383b2-a375-49e0-856f-f820e03934e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>beam_params_label</span></div><div class='xr-var-dims'>(beam_params_label)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;major&#x27; &#x27;minor&#x27; &#x27;pa&#x27;</div><input id='attrs-fd6a570d-5097-41b5-9a96-b46faeb44b03' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fd6a570d-5097-41b5-9a96-b46faeb44b03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a828505b-41a0-4fe9-aede-97f062ee11cc' class='xr-var-data-in' type='checkbox'><label for='data-a828505b-41a0-4fe9-aede-97f062ee11cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;major&#x27;, &#x27;minor&#x27;, &#x27;pa&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-5b208b58-840e-4e79-8e06-304842c44c35' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5b208b58-840e-4e79-8e06-304842c44c35' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d9466f9-2a40-4ed0-b005-d957a80c49e6' class='xr-var-data-in' type='checkbox'><label for='data-9d9466f9-2a40-4ed0-b005-d957a80c49e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cc8500df-888c-47de-89e1-b7a782f9a22a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cc8500df-888c-47de-89e1-b7a782f9a22a' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>rad</dd><dt><span>type :</span></dt><dd>beam_fit_params_sky</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'BEAM_FIT_PARAMS_SKY' (time: 1, frequency: 50,\n",
       "                                         polarization: 4, beam_params_label: 3)> Size: 5kB\n",
       "dask.array<array, shape=(1, 50, 4, 3), dtype=float64, chunksize=(1, 50, 4, 3), chunktype=numpy.ndarray>\n",
       "Coordinates:\n",
       "  * time               (time) float64 8B 5.154e+04\n",
       "  * frequency          (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization       (polarization) <U1 16B 'I' 'Q' 'U' 'V'\n",
       "  * beam_params_label  (beam_params_label) <U5 60B 'major' 'minor' 'pa'\n",
       "    velocity           (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    units:    rad\n",
       "    type:     beam_fit_params_sky"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.BEAM_FIT_PARAMS_SKY"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de474981-9add-40bd-90a5-5bbb08d16a54",
   "metadata": {},
   "source": [
    "All beam parameters are stored in a single array. The final dimension in the beam array is 'beam_param'. The length of this axis is always three. The three \"coordinate\" labels for that axis are for major axis, minor axis, and position angle. The values on the beam_param axis are labeled to allow easy selection using xarray selection methods. For example, one can easily select only the major axis values. Normally, we don't want to drop degenerate dimensions produced by selections, so to avoid that we put the value being selected in square brackets (more on selecting data later)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "100b1bc0-a3c2-4b2f-b31c-4c3cfe6548af",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;BEAM_FIT_PARAMS_SKY&#x27; (time: 1, frequency: 50,\n",
       "                                         polarization: 4, beam_params_label: 1)&gt; Size: 2kB\n",
       "dask.array&lt;getitem, shape=(1, 50, 4, 1), dtype=float64, chunksize=(1, 50, 4, 1), chunktype=numpy.ndarray&gt;\n",
       "Coordinates:\n",
       "  * time               (time) float64 8B 5.154e+04\n",
       "  * frequency          (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization       (polarization) &lt;U1 16B &#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;\n",
       "  * beam_params_label  (beam_params_label) &lt;U5 20B &#x27;major&#x27;\n",
       "    velocity           (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    units:    rad\n",
       "    type:     beam_fit_params_sky</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;BEAM_FIT_PARAMS_SKY&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>frequency</span>: 50</li><li><span class='xr-has-index'>polarization</span>: 4</li><li><span class='xr-has-index'>beam_params_label</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-fa6ccc5a-74be-4a46-b072-3d01a476b7d5' class='xr-array-in' type='checkbox' checked><label for='section-fa6ccc5a-74be-4a46-b072-3d01a476b7d5' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 50, 4, 1), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table style=\"border-collapse: collapse;\">\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 1.56 kiB </td>\n",
       "                        <td> 1.56 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (1, 50, 4, 1) </td>\n",
       "                        <td> (1, 50, 4, 1) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Dask graph </th>\n",
       "                        <td colspan=\"2\"> 1 chunks in 2 graph layers </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Data type </th>\n",
       "                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"347\" height=\"157\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"29\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"29\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"29\" y1=\"0\" x2=\"29\" y2=\"29\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 29.030629010473877,0.0 29.030629010473877,29.030629010473877 0.0,29.030629010473877\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"14.515315\" y=\"49.030629\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >1</text>\n",
       "  <text x=\"49.030629\" y=\"14.515315\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,49.030629,14.515315)\">1</text>\n",
       "\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"99\" y1=\"37\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"99\" y2=\"37\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 169.58823529411765,70.58823529411765 169.58823529411765,107.91480899349406 99.0,37.326573699376404\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"128\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"198\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"169\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"128\" y1=\"0\" x2=\"198\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"99.0,0.0 128.0306290104739,0.0 198.61886430459154,70.58823529411765 169.58823529411765,70.58823529411765\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"198\" y2=\"70\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"169\" y1=\"107\" x2=\"198\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"169\" y1=\"70\" x2=\"169\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"198\" y1=\"70\" x2=\"198\" y2=\"107\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"169.58823529411765,70.58823529411765 198.61886430459154,70.58823529411765 198.61886430459154,107.91480899349406 169.58823529411765,107.91480899349406\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"184.103550\" y=\"127.914809\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >1</text>\n",
       "  <text x=\"218.618864\" y=\"89.251522\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,218.618864,89.251522)\">4</text>\n",
       "  <text x=\"124.294118\" y=\"92.620691\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,124.294118,92.620691)\">50</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table></div></div></li><li class='xr-section-item'><input id='section-3d869e68-46e8-46a4-b97e-8d61575936d6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3d869e68-46e8-46a4-b97e-8d61575936d6' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.154e+04</div><input id='attrs-68b6015f-aee2-498f-92c4-f97bc259cbe4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-68b6015f-aee2-498f-92c4-f97bc259cbe4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fcade432-1b26-4155-b373-0bb0e33cbc14' class='xr-var-data-in' type='checkbox'><label for='data-fcade432-1b26-4155-b373-0bb0e33cbc14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div><div class='xr-var-data'><pre>array([51544.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-252a5bdb-84e5-4e7a-a061-fb176e90df0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-252a5bdb-84e5-4e7a-a061-fb176e90df0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7c08d01-1c3d-4929-8e62-de974bfb57d2' class='xr-var-data-in' type='checkbox'><label for='data-e7c08d01-1c3d-4929-8e62-de974bfb57d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>polarization</span></div><div class='xr-var-dims'>(polarization)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</div><input id='attrs-e31233c8-a3c9-4da5-b45d-10c616842991' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e31233c8-a3c9-4da5-b45d-10c616842991' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-374d5a83-600b-4001-ac91-82c752bb3250' class='xr-var-data-in' type='checkbox'><label for='data-374d5a83-600b-4001-ac91-82c752bb3250' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>beam_params_label</span></div><div class='xr-var-dims'>(beam_params_label)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;major&#x27;</div><input id='attrs-f3c284a7-4c9f-42e2-b9ba-d1de83a4b5e8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3c284a7-4c9f-42e2-b9ba-d1de83a4b5e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fccf4de8-7f4b-4cce-9f7e-ecc5107609cd' class='xr-var-data-in' type='checkbox'><label for='data-fccf4de8-7f4b-4cce-9f7e-ecc5107609cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;major&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-a0ecafcc-2df6-46e5-81ba-ed08e54bb7c6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0ecafcc-2df6-46e5-81ba-ed08e54bb7c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1038805-21c7-4f04-913e-0338653d0d48' class='xr-var-data-in' type='checkbox'><label for='data-f1038805-21c7-4f04-913e-0338653d0d48' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-885e0e6b-08b1-4275-aabd-99ec7d35ddf8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-885e0e6b-08b1-4275-aabd-99ec7d35ddf8' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>rad</dd><dt><span>type :</span></dt><dd>beam_fit_params_sky</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'BEAM_FIT_PARAMS_SKY' (time: 1, frequency: 50,\n",
       "                                         polarization: 4, beam_params_label: 1)> Size: 2kB\n",
       "dask.array<getitem, shape=(1, 50, 4, 1), dtype=float64, chunksize=(1, 50, 4, 1), chunktype=numpy.ndarray>\n",
       "Coordinates:\n",
       "  * time               (time) float64 8B 5.154e+04\n",
       "  * frequency          (frequency) float64 400B 1.415e+09 ... 1.415e+09\n",
       "  * polarization       (polarization) <U1 16B 'I' 'Q' 'U' 'V'\n",
       "  * beam_params_label  (beam_params_label) <U5 20B 'major'\n",
       "    velocity           (frequency) float64 400B 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    units:    rad\n",
       "    type:     beam_fit_params_sky"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.BEAM_FIT_PARAMS_SKY.sel(beam_params_label=[\"major\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d60eb438-ba0c-4607-a0da-d932f56b69a0",
   "metadata": {},
   "source": [
    "## Coordinates"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "376c5caf-10fc-4e46-9317-03239ac95f4c",
   "metadata": {},
   "source": [
    "### Accessing Coordinates"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "199446a2-8069-41f1-a95f-d499da71ab8d",
   "metadata": {},
   "source": [
    "Coordinate are stored as xarray DataArrays. A coordinate may have\n",
    "attributes that provide metadata pertaining to the coordinate.\n",
    "\n",
    "You can explicitly indicate a coordinate is a by referring to the coords\n",
    "dict of the xds. This may make your code more readable. However you can\n",
    "also refer to them using the 'dot' notation, and because a coordinate\n",
    "sometimes has the same name as a dimension (and so is called a dimension\n",
    "coordinate), and because when indexing dimensions you always use the\n",
    "'dot' notation, using the 'dot' notation for coordinates as well is\n",
    "probably ok from a best practice point of view. So, my opinion is\n",
    "either-or."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "47efe502-60c0-4f31-8579-ea18a4f4e397",
   "metadata": {
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 1)&gt; Size: 8B\n",
       "array([51544.])\n",
       "Coordinates:\n",
       "  * time     (time) float64 8B 5.154e+04\n",
       "Attributes:\n",
       "    type:     time\n",
       "    scale:    utc\n",
       "    units:    d\n",
       "    format:   mjd</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;time&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e069fe83-763d-4584-a9a3-4dd2cfe22ace' class='xr-array-in' type='checkbox' checked><label for='section-e069fe83-763d-4584-a9a3-4dd2cfe22ace' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>5.154e+04</span></div><div class='xr-array-data'><pre>array([51544.])</pre></div></div></li><li class='xr-section-item'><input id='section-5261c4e0-bbf7-4c07-a0c4-afedb04f3d5a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5261c4e0-bbf7-4c07-a0c4-afedb04f3d5a' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.154e+04</div><input id='attrs-f3c73db6-78d8-43ea-a914-d1e236c35cfc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3c73db6-78d8-43ea-a914-d1e236c35cfc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3a3f5da-f0f3-48ea-913f-147b2bf9b82e' class='xr-var-data-in' type='checkbox'><label for='data-e3a3f5da-f0f3-48ea-913f-147b2bf9b82e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div><div class='xr-var-data'><pre>array([51544.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e21e51c4-aec6-4340-9951-74ba7d5d28db' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e21e51c4-aec6-4340-9951-74ba7d5d28db' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>time</dd><dt><span>scale :</span></dt><dd>utc</dd><dt><span>units :</span></dt><dd>d</dd><dt><span>format :</span></dt><dd>mjd</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'time' (time: 1)> Size: 8B\n",
       "array([51544.])\n",
       "Coordinates:\n",
       "  * time     (time) float64 8B 5.154e+04\n",
       "Attributes:\n",
       "    type:     time\n",
       "    scale:    utc\n",
       "    units:    d\n",
       "    format:   mjd"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.coords[\"time\"]\n",
    "# or\n",
    "xds.time\n",
    "# or\n",
    "xds[\"time\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "cf55aa93-1a40-4002-b2a1-d7681a15255b",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;polarization&#x27; (polarization: 4)&gt; Size: 16B\n",
       "array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)\n",
       "Coordinates:\n",
       "  * polarization  (polarization) &lt;U1 16B &#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;polarization&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>polarization</span>: 4</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-420d700b-9056-4b71-af14-4f96ce7c312f' class='xr-array-in' type='checkbox' checked><label for='section-420d700b-9056-4b71-af14-4f96ce7c312f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</span></div><div class='xr-array-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-38235506-0013-41e5-8d3f-06c8c2f35e40' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38235506-0013-41e5-8d3f-06c8c2f35e40' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>polarization</span></div><div class='xr-var-dims'>(polarization)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;I&#x27; &#x27;Q&#x27; &#x27;U&#x27; &#x27;V&#x27;</div><input id='attrs-cdedd448-fe8c-4ee6-8b57-969583b18392' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cdedd448-fe8c-4ee6-8b57-969583b18392' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22a65893-45a1-4be1-83aa-4886aff7e630' class='xr-var-data-in' type='checkbox'><label for='data-22a65893-45a1-4be1-83aa-4886aff7e630' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;I&#x27;, &#x27;Q&#x27;, &#x27;U&#x27;, &#x27;V&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'polarization' (polarization: 4)> Size: 16B\n",
       "array(['I', 'Q', 'U', 'V'], dtype='<U1')\n",
       "Coordinates:\n",
       "  * polarization  (polarization) <U1 16B 'I' 'Q' 'U' 'V'"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.polarization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "28320c5a-5188-473e-ace8-da4d6d7db6a8",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;frequency&#x27; (frequency: 50)&gt; Size: 400B\n",
       "array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])\n",
       "Coordinates:\n",
       "  * frequency  (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "    velocity   (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    rest_frequency:       {&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {...\n",
       "    type:                 spectral_coord\n",
       "    units:                Hz\n",
       "    frame:                LSRK\n",
       "    wave_units:           mm\n",
       "    reference_frequency:  {&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;frequency&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>frequency</span>: 50</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9fb0e96b-ea81-4f13-ae41-6876b9e85c66' class='xr-array-in' type='checkbox' checked><label for='section-9fb0e96b-ea81-4f13-ae41-6876b9e85c66' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.415e+09 1.415e+09 1.415e+09 ... 1.415e+09 1.415e+09 1.415e+09</span></div><div class='xr-array-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></div></li><li class='xr-section-item'><input id='section-7bb77f6e-9f7d-4b7b-bad9-302d73ec1b08' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7bb77f6e-9f7d-4b7b-bad9-302d73ec1b08' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-35a33b57-f60d-4634-ae18-eba1c85c9ef6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35a33b57-f60d-4634-ae18-eba1c85c9ef6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dee6a14c-c6d0-433a-831b-77594425e5be' class='xr-var-data-in' type='checkbox'><label for='data-dee6a14c-c6d0-433a-831b-77594425e5be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-48e0b30f-a871-4ff8-b13c-41489f18caf5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-48e0b30f-a871-4ff8-b13c-41489f18caf5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e00da09c-df2d-480f-bea7-d6c53fd40847' class='xr-var-data-in' type='checkbox'><label for='data-e00da09c-df2d-480f-bea7-d6c53fd40847' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8a533fde-f1db-4dfa-93f0-82a2fc3f04d8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a533fde-f1db-4dfa-93f0-82a2fc3f04d8' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'frequency' (frequency: 50)> Size: 400B\n",
       "array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])\n",
       "Coordinates:\n",
       "  * frequency  (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "    velocity   (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    rest_frequency:       {'data': 1420405751.7860003, 'dims': [], 'attrs': {...\n",
       "    type:                 spectral_coord\n",
       "    units:                Hz\n",
       "    frame:                LSRK\n",
       "    wave_units:           mm\n",
       "    reference_frequency:  {'attrs': {'units': 'Hz', 'observer': 'lsrk', 'type..."
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.frequency"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "3eef1067-8d70-4cdd-84ca-201fe312a68e",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;velocity&#x27; (frequency: 50)&gt; Size: 400B\n",
       "array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])\n",
       "Coordinates:\n",
       "  * frequency  (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "    velocity   (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    doppler_type:  radio\n",
       "    units:         m/s\n",
       "    type:          doppler</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;velocity&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>frequency</span>: 50</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b2bd365d-2c83-4678-ad11-a5a3b7dd13fc' class='xr-array-in' type='checkbox' checked><label for='section-b2bd365d-2c83-4678-ad11-a5a3b7dd13fc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.146e+06 1.146e+06 1.146e+06 ... 1.136e+06 1.136e+06 1.136e+06</span></div><div class='xr-array-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></div></li><li class='xr-section-item'><input id='section-00e169cb-77cf-481f-9a44-5a0bf5711546' class='xr-section-summary-in' type='checkbox'  checked><label for='section-00e169cb-77cf-481f-9a44-5a0bf5711546' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.415e+09 1.415e+09 ... 1.415e+09</div><input id='attrs-8e86dfae-1acf-4346-a4b0-d9fdbcd6e86d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e86dfae-1acf-4346-a4b0-d9fdbcd6e86d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-53ffafad-79c0-4eef-a9c5-0aac374900ae' class='xr-var-data-in' type='checkbox'><label for='data-53ffafad-79c0-4eef-a9c5-0aac374900ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>rest_frequency :</span></dt><dd>{&#x27;data&#x27;: 1420405751.7860003, &#x27;dims&#x27;: [], &#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;type&#x27;: &#x27;quantity&#x27;}}</dd><dt><span>type :</span></dt><dd>spectral_coord</dd><dt><span>units :</span></dt><dd>Hz</dd><dt><span>frame :</span></dt><dd>LSRK</dd><dt><span>wave_units :</span></dt><dd>mm</dd><dt><span>reference_frequency :</span></dt><dd>{&#x27;attrs&#x27;: {&#x27;units&#x27;: &#x27;Hz&#x27;, &#x27;observer&#x27;: &#x27;lsrk&#x27;, &#x27;type&#x27;: &#x27;spectral_coord&#x27;}, &#x27;data&#x27;: 1415000000.0, &#x27;dims&#x27;: []}</dd></dl></div><div class='xr-var-data'><pre>array([1.414975e+09, 1.414976e+09, 1.414977e+09, 1.414978e+09, 1.414979e+09,\n",
       "       1.414980e+09, 1.414981e+09, 1.414982e+09, 1.414983e+09, 1.414984e+09,\n",
       "       1.414985e+09, 1.414986e+09, 1.414987e+09, 1.414988e+09, 1.414989e+09,\n",
       "       1.414990e+09, 1.414991e+09, 1.414992e+09, 1.414993e+09, 1.414994e+09,\n",
       "       1.414995e+09, 1.414996e+09, 1.414997e+09, 1.414998e+09, 1.414999e+09,\n",
       "       1.415000e+09, 1.415001e+09, 1.415002e+09, 1.415003e+09, 1.415004e+09,\n",
       "       1.415005e+09, 1.415006e+09, 1.415007e+09, 1.415008e+09, 1.415009e+09,\n",
       "       1.415010e+09, 1.415011e+09, 1.415012e+09, 1.415013e+09, 1.415014e+09,\n",
       "       1.415015e+09, 1.415016e+09, 1.415017e+09, 1.415018e+09, 1.415019e+09,\n",
       "       1.415020e+09, 1.415021e+09, 1.415022e+09, 1.415023e+09, 1.415024e+09])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.146e+06 1.146e+06 ... 1.136e+06</div><input id='attrs-6dac1aca-0c04-4ec7-8ae6-671903441df0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6dac1aca-0c04-4ec7-8ae6-671903441df0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5d4b3da-f378-4094-9c32-fbdaa418edfb' class='xr-var-data-in' type='checkbox'><label for='data-c5d4b3da-f378-4094-9c32-fbdaa418edfb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div><div class='xr-var-data'><pre>array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-391df00a-7b69-42bb-9a70-357a8c9eed3b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-391df00a-7b69-42bb-9a70-357a8c9eed3b' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>doppler_type :</span></dt><dd>radio</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>type :</span></dt><dd>doppler</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'velocity' (frequency: 50)> Size: 400B\n",
       "array([1146220.665937  , 1146009.60479647, 1145798.54365594,\n",
       "       1145587.48251538, 1145376.42137485, 1145165.36023431,\n",
       "       1144954.29909378, 1144743.23795325, 1144532.17681269,\n",
       "       1144321.11567215, 1144110.05453162, 1143898.99339109,\n",
       "       1143687.93225053, 1143476.87111   , 1143265.80996946,\n",
       "       1143054.74882893, 1142843.6876884 , 1142632.62654784,\n",
       "       1142421.56540731, 1142210.50426677, 1141999.44312624,\n",
       "       1141788.38198568, 1141577.32084515, 1141366.25970461,\n",
       "       1141155.19856408, 1140944.13742352, 1140733.07628299,\n",
       "       1140522.01514246, 1140310.95400192, 1140099.89286139,\n",
       "       1139888.83172083, 1139677.7705803 , 1139466.70943977,\n",
       "       1139255.64829923, 1139044.58715867, 1138833.52601814,\n",
       "       1138622.46487761, 1138411.40373707, 1138200.34259654,\n",
       "       1137989.28145598, 1137778.22031545, 1137567.15917492,\n",
       "       1137356.09803438, 1137145.03689382, 1136933.97575329,\n",
       "       1136722.91461276, 1136511.85347223, 1136300.79233169,\n",
       "       1136089.73119113, 1135878.6700506 ])\n",
       "Coordinates:\n",
       "  * frequency  (frequency) float64 400B 1.415e+09 1.415e+09 ... 1.415e+09\n",
       "    velocity   (frequency) float64 400B 1.146e+06 1.146e+06 ... 1.136e+06\n",
       "Attributes:\n",
       "    doppler_type:  radio\n",
       "    units:         m/s\n",
       "    type:          doppler"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.velocity"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8eb6e9f-3221-4202-8d9d-9b14310eda3f",
   "metadata": {},
   "source": [
    "For astronomical images, the longitude-like (eg, RA) and latitude-like\n",
    "(eg, Dec) coordinates are functions of both the *l* and *m* dimensions\n",
    "and so are 2-D arrays to properly account for sky curvature. These\n",
    "values are generally in radians. The coordinate name will depend on what\n",
    "is represented, eg it could be galactic_longitude for an image that uses\n",
    "galactic coordinates."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "461e22ea-506c-4d05-8801-e95c557da81f",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;right_ascension&#x27; (l: 200, m: 100)&gt; Size: 160kB\n",
       "array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))\n",
       "Coordinates:\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;right_ascension&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>l</span>: 200</li><li><span class='xr-has-index'>m</span>: 100</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-96888f3f-dbfa-4e34-b991-7d200fe48692' class='xr-array-in' type='checkbox' checked><label for='section-96888f3f-dbfa-4e34-b991-7d200fe48692' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0291 0.0291 0.0291 0.0291 0.0291 ... 6.254 6.254 6.254 6.254 6.254</span></div><div class='xr-array-data'><pre>array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))</pre></div></div></li><li class='xr-section-item'><input id='section-ed7a1926-9bed-4ae1-8d78-37fbbe251906' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ed7a1926-9bed-4ae1-8d78-37fbbe251906' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>l</span></div><div class='xr-var-dims'>(l)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02909 0.0288 ... -0.02851 -0.0288</div><input id='attrs-7c229b94-04b7-44e5-85d1-cebaa56aa4e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c229b94-04b7-44e5-85d1-cebaa56aa4e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-787353c0-b1a0-48e3-b2be-1ad38a429736' class='xr-var-data-in' type='checkbox'><label for='data-787353c0-b1a0-48e3-b2be-1ad38a429736' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>l is the angle measured from the reference direction to the east. So l = x*cdelt, where x is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([ 0.029089,  0.028798,  0.028507,  0.028216,  0.027925,  0.027634,\n",
       "        0.027343,  0.027053,  0.026762,  0.026471,  0.02618 ,  0.025889,\n",
       "        0.025598,  0.025307,  0.025016,  0.024725,  0.024435,  0.024144,\n",
       "        0.023853,  0.023562,  0.023271,  0.02298 ,  0.022689,  0.022398,\n",
       "        0.022108,  0.021817,  0.021526,  0.021235,  0.020944,  0.020653,\n",
       "        0.020362,  0.020071,  0.01978 ,  0.01949 ,  0.019199,  0.018908,\n",
       "        0.018617,  0.018326,  0.018035,  0.017744,  0.017453,  0.017162,\n",
       "        0.016872,  0.016581,  0.01629 ,  0.015999,  0.015708,  0.015417,\n",
       "        0.015126,  0.014835,  0.014544,  0.014254,  0.013963,  0.013672,\n",
       "        0.013381,  0.01309 ,  0.012799,  0.012508,  0.012217,  0.011926,\n",
       "        0.011636,  0.011345,  0.011054,  0.010763,  0.010472,  0.010181,\n",
       "        0.00989 ,  0.009599,  0.009308,  0.009018,  0.008727,  0.008436,\n",
       "        0.008145,  0.007854,  0.007563,  0.007272,  0.006981,  0.00669 ,\n",
       "        0.0064  ,  0.006109,  0.005818,  0.005527,  0.005236,  0.004945,\n",
       "        0.004654,  0.004363,  0.004072,  0.003782,  0.003491,  0.0032  ,\n",
       "        0.002909,  0.002618,  0.002327,  0.002036,  0.001745,  0.001454,\n",
       "        0.001164,  0.000873,  0.000582,  0.000291,  0.      , -0.000291,\n",
       "       -0.000582, -0.000873, -0.001164, -0.001454, -0.001745, -0.002036,\n",
       "       -0.002327, -0.002618, -0.002909, -0.0032  , -0.003491, -0.003782,\n",
       "       -0.004072, -0.004363, -0.004654, -0.004945, -0.005236, -0.005527,\n",
       "       -0.005818, -0.006109, -0.0064  , -0.00669 , -0.006981, -0.007272,\n",
       "       -0.007563, -0.007854, -0.008145, -0.008436, -0.008727, -0.009018,\n",
       "       -0.009308, -0.009599, -0.00989 , -0.010181, -0.010472, -0.010763,\n",
       "       -0.011054, -0.011345, -0.011636, -0.011926, -0.012217, -0.012508,\n",
       "       -0.012799, -0.01309 , -0.013381, -0.013672, -0.013963, -0.014254,\n",
       "       -0.014544, -0.014835, -0.015126, -0.015417, -0.015708, -0.015999,\n",
       "       -0.01629 , -0.016581, -0.016872, -0.017162, -0.017453, -0.017744,\n",
       "       -0.018035, -0.018326, -0.018617, -0.018908, -0.019199, -0.01949 ,\n",
       "       -0.01978 , -0.020071, -0.020362, -0.020653, -0.020944, -0.021235,\n",
       "       -0.021526, -0.021817, -0.022108, -0.022398, -0.022689, -0.02298 ,\n",
       "       -0.023271, -0.023562, -0.023853, -0.024144, -0.024435, -0.024725,\n",
       "       -0.025016, -0.025307, -0.025598, -0.025889, -0.02618 , -0.026471,\n",
       "       -0.026762, -0.027053, -0.027343, -0.027634, -0.027925, -0.028216,\n",
       "       -0.028507, -0.028798])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>m</span></div><div class='xr-var-dims'>(m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-46e0faab-c927-44dd-adc7-a64e2ada57e5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46e0faab-c927-44dd-adc7-a64e2ada57e5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9923e447-4d16-48ef-b7e0-26d27029f548' class='xr-var-data-in' type='checkbox'><label for='data-9923e447-4d16-48ef-b7e0-26d27029f548' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>m is the angle measured from the reference direction to the north. So m = y*cdelt, where y is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([-0.014544, -0.014254, -0.013963, -0.013672, -0.013381, -0.01309 ,\n",
       "       -0.012799, -0.012508, -0.012217, -0.011926, -0.011636, -0.011345,\n",
       "       -0.011054, -0.010763, -0.010472, -0.010181, -0.00989 , -0.009599,\n",
       "       -0.009308, -0.009018, -0.008727, -0.008436, -0.008145, -0.007854,\n",
       "       -0.007563, -0.007272, -0.006981, -0.00669 , -0.0064  , -0.006109,\n",
       "       -0.005818, -0.005527, -0.005236, -0.004945, -0.004654, -0.004363,\n",
       "       -0.004072, -0.003782, -0.003491, -0.0032  , -0.002909, -0.002618,\n",
       "       -0.002327, -0.002036, -0.001745, -0.001454, -0.001164, -0.000873,\n",
       "       -0.000582, -0.000291,  0.      ,  0.000291,  0.000582,  0.000873,\n",
       "        0.001164,  0.001454,  0.001745,  0.002036,  0.002327,  0.002618,\n",
       "        0.002909,  0.0032  ,  0.003491,  0.003782,  0.004072,  0.004363,\n",
       "        0.004654,  0.004945,  0.005236,  0.005527,  0.005818,  0.006109,\n",
       "        0.0064  ,  0.00669 ,  0.006981,  0.007272,  0.007563,  0.007854,\n",
       "        0.008145,  0.008436,  0.008727,  0.009018,  0.009308,  0.009599,\n",
       "        0.00989 ,  0.010181,  0.010472,  0.010763,  0.011054,  0.011345,\n",
       "        0.011636,  0.011926,  0.012217,  0.012508,  0.012799,  0.01309 ,\n",
       "        0.013381,  0.013672,  0.013963,  0.014254])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>right_ascension</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0291 0.0291 ... 6.254 6.254</div><input id='attrs-d76f5236-f63b-4a64-91d2-f7fdb79cec86' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d76f5236-f63b-4a64-91d2-f7fdb79cec86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85820fe9-e1d2-430d-bdd5-3e98bb935d41' class='xr-var-data-in' type='checkbox'><label for='data-85820fe9-e1d2-430d-bdd5-3e98bb935d41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>declination</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-9dc41082-10cf-4267-bc79-c199656917e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9dc41082-10cf-4267-bc79-c199656917e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49ee9a26-d6a9-43f8-9437-763660d8ab05' class='xr-var-data-in' type='checkbox'><label for='data-49ee9a26-d6a9-43f8-9437-763660d8ab05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))</pre></div></li></ul></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'right_ascension' (l: 200, m: 100)> Size: 160kB\n",
       "array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))\n",
       "Coordinates:\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.right_ascension"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "e74f019f-d5a9-4da1-965b-402683191067",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base rgba(0, 0, 0, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, white)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n",
       "  );\n",
       "}\n",
       "\n",
       "html[theme=\"dark\"],\n",
       "html[data-theme=\"dark\"],\n",
       "body[data-theme=\"dark\"],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: var(\n",
       "    --jp-content-font-color0,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n",
       "  );\n",
       "  --xr-font-color2: var(\n",
       "    --jp-content-font-color2,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n",
       "  );\n",
       "  --xr-font-color3: var(\n",
       "    --jp-content-font-color3,\n",
       "    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n",
       "  );\n",
       "  --xr-border-color: var(\n",
       "    --jp-border-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n",
       "  );\n",
       "  --xr-disabled-color: var(\n",
       "    --jp-layout-color3,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n",
       "  );\n",
       "  --xr-background-color: var(\n",
       "    --jp-layout-color0,\n",
       "    var(--pst-color-on-background, #111111)\n",
       "  );\n",
       "  --xr-background-color-row-even: var(\n",
       "    --jp-layout-color1,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n",
       "  );\n",
       "  --xr-background-color-row-odd: var(\n",
       "    --jp-layout-color2,\n",
       "    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n",
       "  );\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block !important;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "  line-height: 1.6;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-obj-name,\n",
       ".xr-group-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-group-name::before {\n",
       "  content: \"ðŸ“\";\n",
       "  padding-right: 0.3em;\n",
       "}\n",
       "\n",
       ".xr-group-name,\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n",
       "  margin-block-start: 0;\n",
       "  margin-block-end: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: inline-block;\n",
       "  opacity: 0;\n",
       "  height: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "  border: 2px solid transparent !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:focus + label {\n",
       "  border: 2px solid var(--xr-font-color0) !important;\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: \"â–º\";\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: \"â–¼\";\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-top: 4px;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-group-box {\n",
       "  display: inline-grid;\n",
       "  grid-template-columns: 0px 20px auto;\n",
       "  width: 100%;\n",
       "}\n",
       "\n",
       ".xr-group-box-vline {\n",
       "  grid-column-start: 1;\n",
       "  border-right: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "  width: 0px;\n",
       "}\n",
       "\n",
       ".xr-group-box-hline {\n",
       "  grid-column-start: 2;\n",
       "  grid-row-start: 1;\n",
       "  height: 1em;\n",
       "  width: 20px;\n",
       "  border-bottom: 0.2em solid;\n",
       "  border-color: var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-group-box-contents {\n",
       "  grid-column-start: 3;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: \"(\";\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: \")\";\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: \",\";\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  border-color: var(--xr-background-color-row-odd);\n",
       "  margin-bottom: 0;\n",
       "  padding-top: 2px;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "  border-color: var(--xr-background-color-row-even);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-index-preview {\n",
       "  grid-column: 2 / 5;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  display: none;\n",
       "  border-top: 2px dotted var(--xr-background-color);\n",
       "  padding-bottom: 20px !important;\n",
       "  padding-top: 10px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in + label,\n",
       ".xr-var-data-in + label,\n",
       ".xr-index-data-in + label {\n",
       "  padding: 0 1px;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data,\n",
       ".xr-index-data-in:checked ~ .xr-index-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-data > pre,\n",
       ".xr-index-data > pre,\n",
       ".xr-var-data > table > tbody > tr {\n",
       "  background-color: transparent !important;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-index-name div,\n",
       ".xr-index-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data,\n",
       ".xr-index-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt,\n",
       ".xr-attrs dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2,\n",
       ".xr-no-icon {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n",
       ".xr-var-data-in:checked + label > .xr-icon-database,\n",
       ".xr-index-data-in:checked + label > .xr-icon-database {\n",
       "  color: var(--xr-font-color0);\n",
       "  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n",
       "  stroke-width: 0.8px;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;declination&#x27; (l: 200, m: 100)&gt; Size: 160kB\n",
       "array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))\n",
       "Coordinates:\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;declination&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>l</span>: 200</li><li><span class='xr-has-index'>m</span>: 100</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-235615b9-1745-4eba-9626-e672db89548c' class='xr-array-in' type='checkbox' checked><label for='section-235615b9-1745-4eba-9626-e672db89548c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.01454 -0.01425 -0.01396 -0.01367 ... 0.01367 0.01396 0.01425</span></div><div class='xr-array-data'><pre>array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))</pre></div></div></li><li class='xr-section-item'><input id='section-fc0c3afa-3717-46dd-ac55-bc41ff401356' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fc0c3afa-3717-46dd-ac55-bc41ff401356' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>l</span></div><div class='xr-var-dims'>(l)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02909 0.0288 ... -0.02851 -0.0288</div><input id='attrs-2c281aeb-e14f-43fd-b027-281d4ae0885a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c281aeb-e14f-43fd-b027-281d4ae0885a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0abe1cca-3571-4c25-9c21-0c639b59bafc' class='xr-var-data-in' type='checkbox'><label for='data-0abe1cca-3571-4c25-9c21-0c639b59bafc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>l is the angle measured from the reference direction to the east. So l = x*cdelt, where x is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([ 0.029089,  0.028798,  0.028507,  0.028216,  0.027925,  0.027634,\n",
       "        0.027343,  0.027053,  0.026762,  0.026471,  0.02618 ,  0.025889,\n",
       "        0.025598,  0.025307,  0.025016,  0.024725,  0.024435,  0.024144,\n",
       "        0.023853,  0.023562,  0.023271,  0.02298 ,  0.022689,  0.022398,\n",
       "        0.022108,  0.021817,  0.021526,  0.021235,  0.020944,  0.020653,\n",
       "        0.020362,  0.020071,  0.01978 ,  0.01949 ,  0.019199,  0.018908,\n",
       "        0.018617,  0.018326,  0.018035,  0.017744,  0.017453,  0.017162,\n",
       "        0.016872,  0.016581,  0.01629 ,  0.015999,  0.015708,  0.015417,\n",
       "        0.015126,  0.014835,  0.014544,  0.014254,  0.013963,  0.013672,\n",
       "        0.013381,  0.01309 ,  0.012799,  0.012508,  0.012217,  0.011926,\n",
       "        0.011636,  0.011345,  0.011054,  0.010763,  0.010472,  0.010181,\n",
       "        0.00989 ,  0.009599,  0.009308,  0.009018,  0.008727,  0.008436,\n",
       "        0.008145,  0.007854,  0.007563,  0.007272,  0.006981,  0.00669 ,\n",
       "        0.0064  ,  0.006109,  0.005818,  0.005527,  0.005236,  0.004945,\n",
       "        0.004654,  0.004363,  0.004072,  0.003782,  0.003491,  0.0032  ,\n",
       "        0.002909,  0.002618,  0.002327,  0.002036,  0.001745,  0.001454,\n",
       "        0.001164,  0.000873,  0.000582,  0.000291,  0.      , -0.000291,\n",
       "       -0.000582, -0.000873, -0.001164, -0.001454, -0.001745, -0.002036,\n",
       "       -0.002327, -0.002618, -0.002909, -0.0032  , -0.003491, -0.003782,\n",
       "       -0.004072, -0.004363, -0.004654, -0.004945, -0.005236, -0.005527,\n",
       "       -0.005818, -0.006109, -0.0064  , -0.00669 , -0.006981, -0.007272,\n",
       "       -0.007563, -0.007854, -0.008145, -0.008436, -0.008727, -0.009018,\n",
       "       -0.009308, -0.009599, -0.00989 , -0.010181, -0.010472, -0.010763,\n",
       "       -0.011054, -0.011345, -0.011636, -0.011926, -0.012217, -0.012508,\n",
       "       -0.012799, -0.01309 , -0.013381, -0.013672, -0.013963, -0.014254,\n",
       "       -0.014544, -0.014835, -0.015126, -0.015417, -0.015708, -0.015999,\n",
       "       -0.01629 , -0.016581, -0.016872, -0.017162, -0.017453, -0.017744,\n",
       "       -0.018035, -0.018326, -0.018617, -0.018908, -0.019199, -0.01949 ,\n",
       "       -0.01978 , -0.020071, -0.020362, -0.020653, -0.020944, -0.021235,\n",
       "       -0.021526, -0.021817, -0.022108, -0.022398, -0.022689, -0.02298 ,\n",
       "       -0.023271, -0.023562, -0.023853, -0.024144, -0.024435, -0.024725,\n",
       "       -0.025016, -0.025307, -0.025598, -0.025889, -0.02618 , -0.026471,\n",
       "       -0.026762, -0.027053, -0.027343, -0.027634, -0.027925, -0.028216,\n",
       "       -0.028507, -0.028798])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>m</span></div><div class='xr-var-dims'>(m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-0e6bf4b5-32f2-444e-b198-668c15bd97aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e6bf4b5-32f2-444e-b198-668c15bd97aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbae58f1-5aac-485b-83d8-15c1b317eb76' class='xr-var-data-in' type='checkbox'><label for='data-dbae58f1-5aac-485b-83d8-15c1b317eb76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>m is the angle measured from the reference direction to the north. So m = y*cdelt, where y is the number of pixels from the reference direction. See AIPS Memo #27, Section III.</dd></dl></div><div class='xr-var-data'><pre>array([-0.014544, -0.014254, -0.013963, -0.013672, -0.013381, -0.01309 ,\n",
       "       -0.012799, -0.012508, -0.012217, -0.011926, -0.011636, -0.011345,\n",
       "       -0.011054, -0.010763, -0.010472, -0.010181, -0.00989 , -0.009599,\n",
       "       -0.009308, -0.009018, -0.008727, -0.008436, -0.008145, -0.007854,\n",
       "       -0.007563, -0.007272, -0.006981, -0.00669 , -0.0064  , -0.006109,\n",
       "       -0.005818, -0.005527, -0.005236, -0.004945, -0.004654, -0.004363,\n",
       "       -0.004072, -0.003782, -0.003491, -0.0032  , -0.002909, -0.002618,\n",
       "       -0.002327, -0.002036, -0.001745, -0.001454, -0.001164, -0.000873,\n",
       "       -0.000582, -0.000291,  0.      ,  0.000291,  0.000582,  0.000873,\n",
       "        0.001164,  0.001454,  0.001745,  0.002036,  0.002327,  0.002618,\n",
       "        0.002909,  0.0032  ,  0.003491,  0.003782,  0.004072,  0.004363,\n",
       "        0.004654,  0.004945,  0.005236,  0.005527,  0.005818,  0.006109,\n",
       "        0.0064  ,  0.00669 ,  0.006981,  0.007272,  0.007563,  0.007854,\n",
       "        0.008145,  0.008436,  0.008727,  0.009018,  0.009308,  0.009599,\n",
       "        0.00989 ,  0.010181,  0.010472,  0.010763,  0.011054,  0.011345,\n",
       "        0.011636,  0.011926,  0.012217,  0.012508,  0.012799,  0.01309 ,\n",
       "        0.013381,  0.013672,  0.013963,  0.014254])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>right_ascension</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0291 0.0291 ... 6.254 6.254</div><input id='attrs-dfc00dfd-50bb-49ad-8de6-8c290b01cece' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfc00dfd-50bb-49ad-8de6-8c290b01cece' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-650517f6-ab70-436a-b593-24ade852b296' class='xr-var-data-in' type='checkbox'><label for='data-650517f6-ab70-436a-b593-24ade852b296' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.029096  , 0.02909588, 0.02909576, ..., 0.02909564, 0.02909576,\n",
       "        0.02909588],\n",
       "       [0.02880496, 0.02880484, 0.02880472, ..., 0.02880461, 0.02880472,\n",
       "        0.02880484],\n",
       "       [0.02851392, 0.0285138 , 0.02851369, ..., 0.02851357, 0.02851369,\n",
       "        0.0285138 ],\n",
       "       ...,\n",
       "       [6.25496242, 6.25496254, 6.25496265, ..., 6.25496277, 6.25496265,\n",
       "        6.25496254],\n",
       "       [6.25467138, 6.2546715 , 6.25467162, ..., 6.25467173, 6.25467162,\n",
       "        6.2546715 ],\n",
       "       [6.25438034, 6.25438047, 6.25438058, ..., 6.2543807 , 6.25438058,\n",
       "        6.25438047]], shape=(200, 100))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>declination</span></div><div class='xr-var-dims'>(l, m)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01454 -0.01425 ... 0.01425</div><input id='attrs-b874cbe2-eb7c-4aa9-8417-9a905467de3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b874cbe2-eb7c-4aa9-8417-9a905467de3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7194eacd-45df-4a73-ae28-0e0319a5814d' class='xr-var-data-in' type='checkbox'><label for='data-7194eacd-45df-4a73-ae28-0e0319a5814d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))</pre></div></li></ul></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.DataArray 'declination' (l: 200, m: 100)> Size: 160kB\n",
       "array([[-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       ...,\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ],\n",
       "       [-0.01454492, -0.014254  , -0.01396309, ...,  0.01367217,\n",
       "         0.01396309,  0.014254  ]], shape=(200, 100))\n",
       "Coordinates:\n",
       "  * l                (l) float64 2kB 0.02909 0.0288 0.02851 ... -0.02851 -0.0288\n",
       "  * m                (m) float64 800B -0.01454 -0.01425 ... 0.01396 0.01425\n",
       "    right_ascension  (l, m) float64 160kB 0.0291 0.0291 0.0291 ... 6.254 6.254\n",
       "    declination      (l, m) float64 160kB -0.01454 -0.01425 ... 0.01396 0.01425"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.declination"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b147607d-804d-4e62-953f-a7aee87c6cc5",
   "metadata": {},
   "source": [
    "### Coordinate Attributes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d4dadb3-9376-48c7-8a0d-4e7dee4527e2",
   "metadata": {
    "tags": []
   },
   "source": [
    "All coordinates, except polarization, have attributes, which are metadata that describe the coordinate. These are dictionaries that are stored in the attrs field of the coordinate.\n",
    "\n",
    "#### attrs is a dict and accessible via the attrs field"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "c30113b7-a3c8-4e90-86fd-eebd465e0568",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'type': 'time', 'scale': 'utc', 'units': 'd', 'format': 'mjd'}"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.time.attrs"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "22a99d4d-453e-4846-936a-31da04074b9c",
   "metadata": {},
   "source": [
    "####  prefer to access attrs via the explicit attrs field rather than dot notation\n",
    "You can again access attributes with the 'dot' notation, but because\n",
    "attributes can be numerous, I generally indicate explicitly that I'm\n",
    "referring to an attribute by explicitly naming the attrs field. IMO this\n",
    "is best practice when referring to attributes. It's a bit easier to \n",
    "distinguish coordinate attributes using the 'dot' notation than it is\n",
    "to distinguish dataset attributes (discussed later), but for\n",
    "consistency I like to explicitly refer to the attrs field in both cases."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "8fec73fe-fe5d-4ec4-a389-98f6d727604f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'d'"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# So I don't recommend this, even though it is valid\n",
    "xds.time.units\n",
    "# I instead recommend this\n",
    "xds.time.attrs[\"units\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "837f3916-4a6d-4e2e-8c7b-9bb3433a5fdb",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'rest_frequency': {'data': 1420405751.7860003,\n",
       "  'dims': [],\n",
       "  'attrs': {'units': 'Hz', 'type': 'quantity'}},\n",
       " 'type': 'spectral_coord',\n",
       " 'units': 'Hz',\n",
       " 'frame': 'LSRK',\n",
       " 'wave_units': 'mm',\n",
       " 'reference_frequency': {'attrs': {'units': 'Hz',\n",
       "   'observer': 'lsrk',\n",
       "   'type': 'spectral_coord'},\n",
       "  'data': 1415000000.0,\n",
       "  'dims': []}}"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.frequency.attrs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "93a59b78-0ead-44f0-9283-565075eda9cb",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'doppler_type': 'radio', 'units': 'm/s', 'type': 'doppler'}"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.velocity.attrs"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e943c5c-4509-4b58-8fb0-898be6469aaa",
   "metadata": {},
   "source": [
    "For astronomical images, the longitude-like and latitude-like coordinate have both seperable attributes and shared attributes. The separable attributes are stored with the coordinate. The shared attributes are stored in the 'direction' attribute of the xds."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4aad3e7c-bcfd-44e3-ba28-576256e4f49b",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{}"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.right_ascension.attrs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "dd005234-40ae-445c-a04e-136603ac23ef",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{}"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.declination.attrs"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ea313b75-84b4-4d69-813e-e1bf8146cdf3",
   "metadata": {},
   "source": [
    "##  Dateset Level Attributes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "38883680-e1a0-47b8-bd1d-4534543843ef",
   "metadata": {
    "tags": []
   },
   "source": [
    "Metadata that apply to the dataset as a whole are stored in dataset\n",
    "level attributes. The one that is almost always present is the direction attr. This\n",
    "has all the information associated with the CASA image direction coordinate. Because the\n",
    "direction coordinate has some non-separable information, all the metadata associated with\n",
    "it is at the ImageSet level rather than at the l, m coordinate level"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "e62d0a1a-514e-4fd6-8b92-9627fa6ccf2d",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['coordinate_system_info', 'type', 'data_groups'])"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xds.attrs.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a7ad2e6a-0db2-412c-aea4-30cff4a297d2",
   "metadata": {},
   "source": [
    "This is the shared direction coordinate metadata at the xds level. Note that system='J2000' in the CASA image maps to system='FK5' (the frame in astropy speak) and equinox='J2000' in the xds image. This is how astropy requires these details to be provided.\n",
    "\n",
    "It was decided that it would be simpler to keep all the direction metadata in one place rather than having the separable bits associated with the l and m coordinates and having the non-separable bits at the Dataset level."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "d754e8ce-c1dc-4b8c-96d9-458a272f9c09",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'direction'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[26], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[43mxds\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mattrs\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mdirection\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\n",
      "\u001b[0;31mKeyError\u001b[0m: 'direction'"
     ]
    }
   ],
   "source": [
    "xds.attrs[\"direction\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69de4c51-9b7c-4797-9c3a-c464af840af1",
   "metadata": {},
   "source": [
    "Most of the image-specific metadata is associated with individual images within the image set.\n",
    "Here are some examples."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63a7cc71-43c5-4123-8329-e52c2cf149bb",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"telescope\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d830f89a-17aa-4e9e-8c3c-94357c3f153b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"observer\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "affcef16-0578-4e02-8e37-81c29e15f6eb",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"obsdate\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f356e8e2-3c5d-429b-9b8e-add27e60ed44",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"pointing_center\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c42d1f6a-d0ec-41f5-acdc-3ab5d0eb448b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"object_name\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "48c692c7-d298-46c4-b848-5fc7ebf12106",
   "metadata": {},
   "source": [
    "### Cannot set attr using dot notation\n",
    "xarray does not permit setting of attributes using 'dot' notation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3450b527-5715-4411-9ad7-86c87ee3188a",
   "metadata": {},
   "outputs": [],
   "source": [
    "try:\n",
    "    xds.object_name = \"SgrB2\"\n",
    "    print(\n",
    "        \"Wow! You have superhuman python powers. We would like to hire you as an \"\n",
    "        \"assistant superhero python developer with the Avengers!\"\n",
    "    )\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    print(\n",
    "        \"\\nAww. You only have regular human python powers. Thanks for applying for a \"\n",
    "        \"position with the Avengers, but we have no use for your feeble regular human \"\n",
    "        \"python powers at this time.\"\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8923c27f-90f1-445c-9e7b-c984e88268fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"object_name\"] = \"SgrB2\"\n",
    "xds[\"SKY\"].attrs[\"object_name\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "91db2ed4-cb3f-433f-a39b-d0b21d35f4aa",
   "metadata": {},
   "source": [
    "### User attr dictionary\n",
    "The 'user' attribute is for user specified metadata.\n",
    "This is also where metadata from the CASA image 'miscinfo' dictionary are written.\n",
    "misc_info data will be associated with the individual image. There is nothing preventing\n",
    "you from adding your own user data at the ImageSet level though, although you may to have\n",
    "to add a user dictionary at this level first."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9457749f-2e35-4e65-bcc4-8c055aecf01c",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds.attrs[\"user\"] = {}\n",
    "xds.attrs[\"user\"][\"phone\"] = 123456\n",
    "xds.attrs[\"user\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1652af46-54bc-492e-97b2-fe74f5cd7ed6",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"description\"]  # this image has no description"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a37f3980-b1d5-4ab6-aab1-cffba8c690ac",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"description\"] = \"my way cool pretend image\"\n",
    "xds[\"SKY\"].attrs[\"description\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d25e500a-139b-45a4-b357-9c5fd2814e82",
   "metadata": {},
   "source": [
    "The history is currently stored as an xarray Dataset at the image level, but the specific\n",
    "format will likely change once a format that can be used for both\n",
    "images and MSes has been specified"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "14a3b13c-c65a-4319-b11e-087038ade72f",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"history\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f5aa7e6-cf89-4227-a639-9d3f73b4dda7",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"history\"].TIME"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aea4ab82-1791-4f13-825c-8cf4561e76c6",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xds[\"SKY\"].attrs[\"history\"].MESSAGE"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1bc17bbf-f4b5-44e9-8492-f8acc7199679",
   "metadata": {},
   "source": [
    "##  Bonus Section: Measures in xradio\n",
    "xradio will support a few types of measures (and the image schema will be\n",
    "updated to support those very soon). A measure will have a type key indicating\n",
    "what type of measure it is. There will be a quantity type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15fb3bbd-41e6-4109-8aa7-fe4a4d089bf3",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\"data\": 4.0, \"dims\": [], \"attrs\": {\"type\": \"quantity\", \"units\": \"m\"}}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4956656f-c561-4011-a092-a92c20a6577e",
   "metadata": {},
   "source": [
    "time type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b51da70-4b14-4930-861d-bc31c67d9b66",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\"data\": 1697666092, \"dims\": [], \"attrs\": {\"type\": \"time\", \"units\": \"s\", \"scale\": \"utc\", \"format\": \"unix\"}}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2b2a975d-41ea-4d72-b1d2-0218e7c9877a",
   "metadata": {},
   "source": [
    "spectral_coord type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fac492d1-4b23-4e6b-9694-4fbe1f7e67a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\n",
    "    \"data\": 1.415e9,\n",
    "    \"dims\": [],\n",
    "    \"attrs\": {\n",
    "        \"type\": \"spectral_coord\",\n",
    "        \"units\": \"Hz\",\n",
    "        \"observer\": \"lsrk\"\n",
    "    }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af24f198-b620-4760-8957-0c1ba2e84ce0",
   "metadata": {},
   "source": [
    "sky_coord type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9547ae0-6d02-4472-b2e6-79750dbd390c",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\"data\": [0.5, -1.0], \"dims\": [\"l\", \"m\"], \"attrs\": {\"type\": \"sky_coord\", \"units\": \"rad\", \"frame\": \"fk5\"}}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e152c24-d0fa-4a63-be57-db25e069dc5a",
   "metadata": {},
   "source": [
    "(geo) location type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1296140d-8643-4518-b6c1-1b46e920deb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\n",
    "    \"data\": [4e6, 3e6, 5e6],\n",
    "    \"attrs\": {\n",
    "        \"type\": \"earch_location\",\n",
    "        \"frame\": \"ITRF\",\n",
    "        \"coordinate_system\": \"geocentric\",\n",
    "        \"units\": \"m\",\n",
    "        \"origin_object_name\": \"earth\"\n",
    "    }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac5e1897-20f0-46e5-8060-d316e5f95c56",
   "metadata": {},
   "source": [
    "and doppler type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb8a0e65-98a8-45bb-8be8-f8086f615765",
   "metadata": {},
   "outputs": [],
   "source": [
    "{\n",
    "    \"data\": 60000,\n",
    "    \"dims\": [\"frequency\"],\n",
    "    \"attrs\": {\n",
    "        \"type\": \"doppler\",\n",
    "        \"units\": \"m/s\",\n",
    "        \"doppler_type\": \"radio\"\n",
    "    }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e3787d22-776d-4391-a9ec-26f0c896f949",
   "metadata": {},
   "source": [
    "##  Data Selection"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b08e24f8-5fdd-4dda-a285-90950edb3c34",
   "metadata": {},
   "source": [
    "###  Using numpy indexing (but don't do this)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b7f5ff11-d9b6-4c65-a75f-a0fc8470bcb6",
   "metadata": {},
   "source": [
    "Basic numpy indexing and slicing can be used to get values, although this method is the least recommended since it assumes the axis ordering. Better ways are discussed later."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f340eba9-2468-4e1f-83fa-0dd56c720caf",
   "metadata": {},
   "source": [
    "####  values returns a numpy array\n",
    "'values' returns a numpy array. Note that with the specified selection below, the output polarization axis will be degenerate. \n",
    "\n",
    "#### Carry along all dimensions when selecting to end up with a valid image XDS\n",
    "The degenerate axis is kept by specifying the corresponding axis selection as [0], rather than 0. In the latter case, the axis will be dropped. In general, we want to carry all dimensions along; an image XDS pixel and mask data variables should always be five dimensional to avoid any ambiguity of dimension number to coordinate mapping."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76e83311-7bd3-475d-8a2f-57e0d44cee18",
   "metadata": {
    "scrolled": true,
    "tags": []
   },
   "outputs": [],
   "source": [
    "vals = xds.SKY[:, [0], 8:9, 5:7, 8:9].values\n",
    "vals"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89168b9d-0cfa-47b0-afe6-96a2602cf747",
   "metadata": {
    "tags": []
   },
   "source": [
    "####  compute() returns an xarray.DataArray\n",
    "Calling compute() returns an xarray DataArray. Similar to above, if the\n",
    "polarization axis selection is not enclosed in [], the pol dimension will\n",
    "be dropped in the output DataArray."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ceeb791a-1ea5-4cde-a876-2023b87b412c",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "xda = xds.SKY[:, [0], 8:9, 5:7, 8:9].compute()\n",
    "xda"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f86f54d5-455b-4381-8f1b-e0a366e2c938",
   "metadata": {},
   "source": [
    "#### But don't use numpy selection syntax, instead select by dimensions and/or coordinates\n",
    "In general, numpy selection syntax is discouraged. It is preferred instead that selection make use of xarray style selection which is based on dimension and coordinate names and labels."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5346bbe2-d657-42d6-9c97-fed9e399e611",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true
   },
   "source": [
    " ### Using `isel()`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ef91a98-ec8b-4d79-a96d-0640cf89f43a",
   "metadata": {},
   "source": [
    "One can select xarray data using indexing by dimension names.\n",
    "This can be done at the xarray.DataArray level, or the xarray.Dataset level.\n",
    "\n",
    "For example, to select stokes I from the first two frequency planes in the Dataset using integer array indices. Remember the numpy selection syntax used to preserve dimensionality when there is a degenerate axis in the output? That applies here as well"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f2fd25c-1f94-4e0c-a47c-e781749572a7",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "freq_0_1 = xds.isel({\"frequency\": slice(0, 2), \"polarization\": [0]})\n",
    "freq_0_1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b89c43e9-5b5b-4229-a62f-bc87618680c2",
   "metadata": {
    "tags": []
   },
   "source": [
    "###  Using `sel()`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8f5ff64d-ded0-4b6a-b78e-a39614107063",
   "metadata": {},
   "source": [
    "Or select by coordinate labels using sel()."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf691312-78bd-4be8-abd1-7525fa8dcab7",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "freq_0_1_labels = xds.sel(frequency=slice(1.414975e9, 1.414976e9), polarization=[\"I\"])\n",
    "freq_0_1_labels"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91d19fb1-e0eb-4432-af7f-17baa36bf655",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "(freq_0_1.SKY.values == freq_0_1_labels.SKY.values).all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d993e300-bda5-477a-8f16-0d4211e55132",
   "metadata": {},
   "source": [
    "###  Chaining `isel()` and `sel()`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b4413d24-9c6f-44d1-a498-4d5337be4765",
   "metadata": {},
   "source": [
    "sel() and isel() can be chained for maximum flexibility. Don't forget to express the pol selection as a list so dimensions are not dropped"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0fd47942-5bc5-4581-a4e1-4bd0e39d1019",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "freq_0_1_isel_sel = xds.isel(frequency=slice(0, 2)).sel(polarization=[\"I\"])\n",
    "freq_0_1_isel_sel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "55816c9f-8bd4-475e-a601-6a641690f83b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "(freq_0_1.SKY.values == freq_0_1_isel_sel.SKY.values).all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "08a0e560-b1df-43fd-91b7-d2836a1719af",
   "metadata": {},
   "source": [
    "### Using where() to define image regions\n",
    "where() is useful for ~~selecting~~ deliniating regions via masking. where() does not select regions, and so it is fundamentally different from isel() and sel() in this regard. It instead conforms to the rules of binary math operations on xarray.Datasets (https://docs.xarray.dev/en/stable/user-guide/computation.html).\n",
    "\n",
    "This is important to understand for what we are about to do next. We are going to mask a region based on a condition specified by what can be thought of as a general function of l and m. This will do what you might expect for xds.sky, but for xds.beam, it will add dimensions l and m because of broadcasting rules. So, here we really just want to mask xds.sky and so will run where() on the xds.sky DataArray, not the entire xds Dataset.\n",
    "\n",
    "Here we select a circular region of radius=40 pixels centered at the image center. Pixel values outside the region are masked (set to nan). We first make a copy so we do not alter the xds dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e0685ae-645e-4af1-9993-ce2cf4286003",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "circle_region = xds.copy(deep=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8836df83-85ff-47e8-9596-ef6d763f4e29",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Note that this code assumes l and m are dimensions, not\n",
    "# dimension coordinates. When there are also l and m\n",
    "# dimension coordinates, the following transformations\n",
    "# will produce the same result as below\n",
    "# xds.l -> xds.dims['l'], xds.m -> xds.dims['m']\n",
    "# ie when there is a dimension and dimension coordinate, just\n",
    "# referring to the dimension/dimension coordinate name means\n",
    "# where() will use the coordinate values. If you want to refer\n",
    "# to the dimension, you explicitly have to express that via\n",
    "# the dims['x'] field.\n",
    "l_shift = xds.l - len(xds.l) / 2\n",
    "m_shift = xds.m - len(xds.m) / 2\n",
    "# deliniate a circular region of radius 40 pixels in\n",
    "# circle_region.sky only\n",
    "circle_region[\"sky\"] = circle_region.SKY.where(l_shift**2 + m_shift**2 <= 1600)\n",
    "circle_region"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bf7e0a4b-2409-482c-8d73-8bff23330aef",
   "metadata": {
    "tags": []
   },
   "source": [
    "###  Example of Complex Region Selection"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "87178d49-680b-4afc-a35c-90be5cbe2f60",
   "metadata": {},
   "source": [
    "Plot the central region of polarizaton=I and the first frequency channel."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31fc6382-ba9d-45f2-a9a9-aecd95e2231d",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# before region selection, note that we are not using the image pixel mask,\n",
    "# MASK_0, for plotting here. This is just a quick and dirty demo; actual\n",
    "# xradio/ngCASA applications will use pixel masks as expected.\n",
    "data_sel = {\"time\": [0], \"polarization\": [0], \"frequency\": [0], \"l\": slice(50, 150)}\n",
    "clim = {\"vmin\": -2, \"vmax\": 6}\n",
    "xds.SKY.isel(data_sel).plot(**clim)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c39d5525-ff82-4459-9a8a-2a0e7e6b9e0e",
   "metadata": {},
   "source": [
    "Deliniate a circular region of radius 40 pixels. Pixel values in the region outside the center circle are NaN."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f156b6e-1887-4f37-8971-e349788c228a",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "circular_region = xds.copy(deep=True)\n",
    "l_shift = xds.l - xds.l[len(xds.l) // 2]\n",
    "m_shift = xds.m - xds.m[len(xds.m) // 2]\n",
    "radius = 40 * abs(xds.l[1] - xds.l[0])\n",
    "circular_region[\"SKY\"] = circular_region[\"SKY\"].where(\n",
    "    l_shift**2 + m_shift**2 <= radius * radius\n",
    ")\n",
    "circular_region"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "acee04e7-088b-4e45-bf9a-22390a1f1a6a",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Here is what the circular region deliniation looks like. Pixel values\n",
    "# outside the selected region are NaN.\n",
    "circular_region.SKY.isel(data_sel).plot(**clim)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "501fd1e2-a479-47f0-a689-6b826a37ddde",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "\n",
    "np.isnan(circular_region.SKY.values).all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "378c4a53-9236-4d6a-bf48-4786ab2abf2b",
   "metadata": {},
   "source": [
    "### Pac Man!\n",
    "With just a little more effort, a Pac Man region can be created."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "040f32a7-d45c-4f10-bcfd-4c6b95c97fc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "\n",
    "# just rename the object, no copying is done here\n",
    "pacman = circular_region\n",
    "pacman[\"SKY\"] = circular_region.SKY.where(\n",
    "    np.logical_or(\n",
    "        np.logical_or(m_shift < 0, l_shift - m_shift > 0), l_shift + m_shift < 0\n",
    "    )\n",
    ")\n",
    "pacman.SKY.isel(data_sel).plot(**clim)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eff7bcbd-8407-4e2f-8419-6ed204171af3",
   "metadata": {},
   "source": [
    "Below in the section on converting an image xds to a CASA image, we will write the pacman xds\n",
    "to a CASA image and demonstrate that the CASA image pixel values agree with the pacman.sky\n",
    "array values."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25d07cca-30e0-4737-a77d-7603ab9916f9",
   "metadata": {},
   "source": [
    "##  Loading Image Data Into Memory\n",
    "In order to process an image's pixel data, it must be loaded into memory. This data must be immediately loaded, so that it cannot be a Dask array. The general architecture is that the loaded data will be placed in a dask.delayed function for processing.\n",
    "\n",
    "A loaded data is itself a valid xds image (it can be correctly thought of as a subimage)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8a5c92f-2304-4908-82b5-85a9e33d096e",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "from xradio.image import load_image, open_image\n",
    "\n",
    "subim = load_image(\n",
    "    \"demo_simulated.im\",\n",
    "    block_des={\n",
    "        \"time\": 0,\n",
    "        \"polarization\": 0,\n",
    "        \"frequency\": slice(0, 10),\n",
    "        \"l\": slice(40, 80),\n",
    "        \"m\": slice(10, 20),\n",
    "    },\n",
    "    do_sky_coords=True,\n",
    ")\n",
    "subim"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b7d55d2-fe7d-41c6-8c72-adff34b3a161",
   "metadata": {},
   "source": [
    "### Loaded data is a numpy array"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e73ffe6f-4d7a-4c2b-a0f5-60843865db97",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "subim.SKY"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ff1a7e4-fb2b-4269-99eb-94e23107ce17",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "subim.MASK_0"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27854ca0-cc9d-457b-a2d7-dd50219d4165",
   "metadata": {},
   "source": [
    "A numpy.ma.masked_array can be created from the pixels and the mask"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "68799610-571a-4331-bfbf-a8c26b02f48a",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "\n",
    "ma = np.ma.masked_array(subim.SKY[:], subim.MASK_0[:])\n",
    "ma"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f022c25f-eaff-448d-93eb-3459d1650853",
   "metadata": {},
   "source": [
    "### Loaded data can be used in a dask.delayed function\n",
    "Now the masked array can be put in a dask.delayed function, and things can be done with it."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "baf5bdcc",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7867ec5-9d5f-4ee5-b50d-0561fb62b835",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "import dask.delayed\n",
    "\n",
    "\n",
    "def summer(ary):\n",
    "    return ary.sum()\n",
    "\n",
    "\n",
    "summer = dask.delayed(summer)(ma)\n",
    "print(ma.shape)\n",
    "print(\"summer type\", type(summer))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "715782aa-bd2e-4af2-9db9-00742f7b583a",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "mysum = summer.compute()\n",
    "mysum"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1aac0b3-ddbc-4ba1-baff-8821f166779e",
   "metadata": {},
   "source": [
    "## Convert an xds image to a CASA image"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6fe3e86c",
   "metadata": {},
   "outputs": [],
   "source": [
    "xds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4deea193-aca6-4b93-91d4-37d93729440b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# For this example, arrays are small so force arrays into a single chunk\n",
    "# so writing doesn't take forever\n",
    "xds = xds.chunk(\"auto\")\n",
    "write_image(xds, \"new_casa.im\", out_format=\"casa\", overwrite=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f97c3f75-fd4e-4950-addd-3a7e69b73ed1",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "from casacore.images import image as cimage\n",
    "\n",
    "myim = cimage(\"new_casa.im\")\n",
    "ia_orig = cimage(imname)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e129cb5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from casacore.tables import table\n",
    "t = table(\"new_casa.im\")\n",
    "t.info()\n",
    "t.summary()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f9fae7d5-2bed-492e-aaa6-eeac865a99bd",
   "metadata": {},
   "source": [
    "### Axes order may be different (pol,freq <-> freq, pol), so transpose as necessary\n",
    "The original image has axes in RA, Dec, Freq, Stokes order. Conversion of an xds image XDS\n",
    "to a casa image results in a casacore image with axes in the order tclean currently writes,\n",
    "RA, Dec, Stokes, Freq, so we must transpose the pixel values of one to compare to the pixel\n",
    "values of the other. And the python-casacore image methods usually access pixels in the\n",
    "reverse order you would expect."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce56c534-6550-4d1a-b4ad-3b4439bc87aa",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "(myim.getdata() == ia_orig.getdata().transpose(1, 0, 2, 3)).all()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "446ad26a-e92b-4640-9883-4b0294828236",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "got = myim.statistics()\n",
    "del got[\"minpos\"], got[\"maxpos\"]\n",
    "exp = ia_orig.statistics()\n",
    "del exp[\"minpos\"], exp[\"maxpos\"]\n",
    "for k in exp.keys():\n",
    "    print(k, np.isclose(got[k][0], exp[k][0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3826346-a9bc-4e3f-bce3-62b05e5f5b2e",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "(myim.getmask() == ia_orig.getmask().transpose(1, 0, 2, 3)).all()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4c77269-924b-4b74-8f7e-265694ccfc76",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# There is no obvious way to close() an image using\n",
    "# the python-casacore API, so delete the objects so\n",
    "# they are removed from the CASA table cache\n",
    "del myim\n",
    "del ia_orig"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "302c8cb5-0586-4a14-8b43-69071cdcf7a8",
   "metadata": {},
   "source": [
    "### Write pacman to CASA image\n",
    "\n",
    "Export the pacman image xds to casa image and plot those pixel data\n",
    "to verify the sky data and casa image data are the same"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50e193f7-0ef4-4437-a2d3-d591ef676858",
   "metadata": {},
   "outputs": [],
   "source": [
    "# try/except needed for debugging in case the cell needs\n",
    "# to be run multiple times, the CASA image must be deleted\n",
    "# to remove it from the CASA table cache. Just do nothing\n",
    "# if the CASA image hasn't been created yet.\n",
    "try:\n",
    "    del pacman_casa\n",
    "except NameError as e:\n",
    "    pass\n",
    "\n",
    "pacman = pacman.chunk(\"auto\")\n",
    "write_image(pacman, \"pacman.im\", \"casa\",overwrite=True)\n",
    "from casacore.images import image as cimage\n",
    "\n",
    "pacman_casa = cimage(\"pacman.im\")\n",
    "pacman_casa_data = pacman_casa.getdata()\n",
    "import xarray as xr\n",
    "\n",
    "xr_pacman_casa_data = xr.DataArray(\n",
    "    pacman_casa_data, dims=[\"frequency\", \"polarization\", \"m\", \"l\"]\n",
    ")\n",
    "casa_data_sel = data_sel.copy()\n",
    "del casa_data_sel[\"time\"]\n",
    "# note that m and l are swapped relative to the pacman xds, so\n",
    "# to easily plot  x-axis = l and y-axis = m, transpose\n",
    "xr_pacman_casa_data = xr_pacman_casa_data.transpose(\n",
    "    \"frequency\", \"polarization\", \"l\", \"m\"\n",
    ")\n",
    "xr_pacman_casa_data.isel(casa_data_sel).plot(**clim)\n",
    "del pacman_casa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b5d797f",
   "metadata": {},
   "outputs": [],
   "source": [
    "viper_client.close()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "timg",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
